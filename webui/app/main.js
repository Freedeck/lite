(()=>{var e,t,n,a,o,s,i={15:(e,t,n)=>{"use strict";var a=n(403);const o=document.querySelector("#editor-btn"),s=document.querySelector("#color"),i=document.querySelector("#name"),r=document.querySelector("#type"),l=document.querySelector("#rendertype");s.onchange=e=>{o.style.backgroundColor=e.srcElement.value,s.dataset.has_set="true";const t=JSON.parse(o.getAttribute("data-interaction"));t.data.color=e.srcElement.value,o.setAttribute("data-interaction",JSON.stringify(t)),universal.loadEditorData(t.data)},i.onkeyup=e=>{o.innerText=e.srcElement.value};const d=[{class:"no-bg",data:"showBg",selector:"#sbg"},{class:"no-border",data:"noBorder",selector:"#nbo"},{class:"no-rounding",data:"noRounding",selector:"#nbr"},{class:"no-shadow",data:"noShadow",selector:"#nsh"}];for(const e of d)document.querySelector(e.selector).onclick=t=>{t.srcElement.checked?o.classList.add(e.class):o.classList.remove(e.class)};universal.listenFor("editTile",((e,t)=>{const n=e.data;o.innerText=t,i.value=t,l.value=e.renderType||"button",s.value=n.color||"none",o.style.backgroundImage="",n.icon&&(o.style.backgroundImage=`url("${n.icon}")`),n.color&&(o.style.backgroundColor=n.color),r.value=e.type||"fd.none";for(const e of d)"true"===n[e.data]?o.classList.add(e.class):o.classList.remove(e.class);if(n._view){for(const e of document.querySelectorAll(".plugin-view"))e.style.display="none";document.querySelector("#plugins-only").style.display="none",document.querySelector(`#plugin-view-${n._view}`).style.display="block"}}));const c=document.querySelector("#editor-save"),u=document.querySelector("#editor-close"),m=document.querySelector("#editor-div"),p=document.querySelector("#editor"),h=document.querySelector(".toggle-sidebar"),g=document.querySelector(".toggle-sidebar button");u.onclick=()=>{universal.uiSounds.playSound("int_no");for(const e of document.querySelectorAll(".k"))e.classList.remove("smaller"),e.classList.remove("blur");universal.keys.classList.remove("smaller"),m.style.animationName="editor-pull-up",p.style.animation="real-fade-out 0.25s",universal.keys.parentElement.style.transform="translate(-50%, -50%)",document.querySelector("#sidebar").style.right="0",o.dataset.state="not",g.style.display="block","0px"===h.style.left&&g.click(),setTimeout((()=>{p.style.animation="",p.style.display="none",m.style.animationName="editor-pull-down",document.querySelector("#color").value="#000000",document.querySelector("#color").dataset.has_set="false",o.style.backgroundColor=""}),249)},c.onclick=()=>{const e=i.value,t=JSON.parse(o.getAttribute("data-interaction")),n=(0,a.ci)();for(const e in n)t.data[e]=n[e];universal.send(universal.events.companion.edit_tile,{name:e,oldName:o.getAttribute("data-pre-edit"),interaction:t}),u.click()}},44:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});const a=["MobileDevice","CurrentPage","Soundboard","Style","Profiles","Footer"];function o(e){return new Promise((t=>{const a=document.querySelector(".sidebar");if(!a)return console.error("Sidebar element not found"),void t();new MutationObserver(((n,a)=>{for(const o of n)for(const n of o.addedNodes)if(n.id===e){universal.CLU("Boot / Sidebar",`Loaded sidebar module ${n.id}`),a.disconnect(),t();break}})).observe(a,{childList:!0,subtree:!0}),n(367)(`./${e}.js`).then((e=>{"function"==typeof e.default&&e.default()}))}))}async function s(){await async function(e){for(const t of e)await o(t)}(a)}},241:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(363);const o=document.querySelector("#type"),s=document.querySelector("#editor-btn");class i extends a.A{constructor(){super("macro","fd.macro","fd.macro_text"),this.setOnRun((({interactionData:e})=>{const t=e.data;t.macro&&(document.querySelector("#macro-type").value="fd.macro"===e.type?"macro":"text",document.querySelector("#macro-macro").value=t.macro)})),this.setOnFirstSetup((()=>{const e=JSON.parse(s.getAttribute("data-interaction"));e.type="fd.macro_text",o.value="fd.macro_text",s.setAttribute("data-interaction",JSON.stringify(e))}))}}const r=i},295:(e,t,n)=>{"use strict";var a=n(340);const o=(e,t,n)=>{document.querySelector(e)&&(document.querySelector(e)[t]=n)},s=()=>document.querySelector("#editor-btn[data-interaction]")?JSON.parse(document.querySelector("#editor-btn[data-interaction]").getAttribute("data-interaction")):{data:{}};universal._Uploads_New=(e=0)=>{1===e?i("audio/*,video/*",(e=>{a.UI.reloadProfile();const t=s();t.data.file=e.newName,o("#editor-btn[data-interaction]","dataset.interaction",JSON.stringify(t)),o("#file.editor-data","innerText",e.newName),o("#path.editor-data","innerText","/sounds/"),o("#audio-file","innerText",e.newName),universal.loadEditorData(t.data),universal.ctx.destructiveView("library"),universal.sendToast(`Successfully uploaded ${e.newName}`,"Library")})):0===e&&i("image/*",(e=>{a.UI.reloadProfile();const t=s();t.data.icon=`/icons/${e.newName}`,o("#editor-btn[data-interaction]","dataset.interaction",JSON.stringify(t)),o("#editor-btn","style.backgroundImage",`url("/icons/${e.newName}")`),universal.loadEditorData(t.data),universal.ctx.destructiveView("library"),universal.sendToast(`Successfully uploaded ${e.newName}`,"Library")}),"icon")};const i=(e,t,n="sound")=>{const a=document.createElement("iframe");a.style.display="none",a.id="dummyFrame",a.name="dummyFrame";const o=document.createElement("form");o.method="post",o.enctype="multipart/form-data",o.action=`/api/upload/${n}`,o.target="dummyFrame",o.style.display="none";const s=document.createElement("input");s.type="file",s.name="file",s.accept=e,s.style.display="none",o.appendChild(s),s.click(),s.onchange=()=>{o.submit(),a.onload=()=>{const e=a.contentDocument,n=JSON.parse(e.querySelector("pre").innerText);t(n),o.remove(),s.remove(),setTimeout((()=>{a.remove()}),500)}},document.body.append(o),document.body.appendChild(a)}},332:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(363);const o=document.querySelector("#editor-btn");class s extends a.A{constructor(){super("profile","fd.profile"),this.setOnRun((({interactionData:e})=>{universal.generateProfileSelect(),document.querySelector("#eprofile-select").value=e.data.profile})),this.setOnFirstSetup((({interactionData:e})=>{const t=JSON.parse(o.getAttribute("data-interaction"));t.type="fd.profile",t.data.profile="Default",o.setAttribute("data-interaction",JSON.stringify(t)),document.querySelector("#type").value="fd.profile",universal.generateProfileSelect(),document.querySelector("#eprofile-select").value=t.data.profile}))}}const i=s},340:(e,t,n)=>{"use strict";n.d(t,{UI:()=>v});var a=n(656);function o(e,t,n){const a=Object.keys(n)[0];if(t.innerHTML=`<div class="button-text"><p>${s(a)}</div></p>`,"true"===e.data.longPress&&"Companion"!==universal.name){const n=Number.parseInt(universal.lclCfg().longPressTime?universal.lclCfg().longPressTime:3),o=e=>{t.dataset.time=0,t.dataset.holding=!0,t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.transform="scale(0.75)",t.style.fontSize="2rem",t.querySelector(".button-text").querySelector("p").innerText=n,t.interval=setInterval((()=>{t.dataset.time=Number.parseInt(t.dataset.time)+1,t.style.backgroundColor=`rgba(0, 0, 0, ${.1*Number.parseInt(t.dataset.time)+.1})`,t.style.transform=`scale(${.75+.05*Number.parseInt(t.dataset.time)})`,t.querySelector(".button-text").querySelector("p").innerText=n-Number.parseInt(t.dataset.time),Number.parseInt(t.dataset.time)>=n&&(i(e),clearInterval(t.interval))}),1e3)},i=o=>{t.dataset.holding=!1,t.style.backgroundColor=e.data.color?e.data.color:"",t.style.transform="",t.style.fontSize="",t.querySelector(".button-text").querySelector("p").innerText=s(a),clearInterval(t.interval),Number.parseInt(t.dataset.time)>=n&&r(o),t.dataset.time=0};t.onmousedown=o,t.onmouseup=i,t.onmouseleave=i,t.ontouchstart=o,t.ontouchend=i,t.ontouchcancel=i,t.ontouchleave=i;const r=t=>{universal.send(universal.events.keypress,{event:t,btn:e})}}else{if("true"===universal.load("cct"))return;"Companion"===universal.name?t.onpointerup=t=>{universal.flags.isEnabled("try_buttons")&&1===t.which&&universal.send(universal.events.keypress,{event:t,btn:e})}:"true"===e.data.onRelease?t.onpointerup=t=>{1===t.which&&universal.send(universal.events.keypress,{event:t,btn:e})}:t.onpointerdown=t=>{("Companion"!==universal.name||universal.flags.isEnabled("try_buttons"))&&1===t.which&&universal.send(universal.events.keypress,{event:t,btn:e})}}if(universal.lclCfg().scroll){const e=t.querySelector("p");e.clientHeight>40&&e.classList.add("too-big")}}const s=e=>e.replace(/</g,"&lt;").replace(/>/g,"&gt;");function i(e,t,n,a=!1){const o=Object.keys(n)[0];t.innerText=o,a&&"Companion"!==universal.name&&(t.style.opacity=.125)}function r(e,t,n,a){if("true"===n.data.showBg&&t.classList.add("no-bg"),"true"===n.data.noBorder&&t.classList.add("no-border"),"true"===n.data.noRounding&&t.classList.add("no-rounding"),"true"===n.data.noShadow&&t.classList.add("no-shadow"),"fd.sound"===e)o(n,t,a);else if("fd.none"===e)i(0,t,a,!0);else if("fd.select"===e)i(0,t,a,!0);else switch(n.renderType){case"button":default:o(n,t,a);break;case"slider":!function(e,t,n){const a=document.createElement("div");a.classList.add("slider-container"),a.dataset.value=e.data.value,t.appendChild(a);const o=document.createElement("div");o.classList.add("slider-title"),o.innerText=Object.keys(n)[0],a.appendChild(o);const s=document.createElement("div");s.classList.add("slider-thumb"),s.classList.add("context-aware"),a.appendChild(s);const i=document.createElement("div");i.classList.add("slider-percentage"),i.innerText=`${e.data.value}${e.data.format?e.data.format:"%"}`,a.appendChild(i),a.dataset.value=e.data.value,s.oncontextmenu=e=>{s.parentElement.parentElement.oncontextmenu(e)};const r=e.position,l=33*Math.floor((r-1)/5)+"%",d=(r-1)%5*20+"%";a.style.top=l,a.style.left=d;let c=!1;const u=t=>{const n=a.getBoundingClientRect();let o;if("vertical"===e.data.direction){let a=t.clientY-n.top;a<0&&(a=0),a>n.height&&(a=n.height),o=(n.height-a)/n.height*(e.data.max-e.data.min)+e.data.min}else{let a=t.clientX-n.left;a<0&&(a=0),a>n.width&&(a=n.width),o=a/n.width*(e.data.max-e.data.min)+e.data.min}o=Math.min(Math.max(o,e.data.min),e.data.max),a.dataset.value=o,e.data.value=o;const s=(o-e.data.min)/(e.data.max-e.data.min)*100;a.style.background="vertical"===e.data.direction?`linear-gradient(to top, var(--slider-background) ${s}%, var(--slider-foreground) ${s}%)`:`linear-gradient(to right, var(--slider-background) ${s}%, var(--slider-foreground) ${s}%)`;const r=Number.parseFloat(o).toFixed(1);i.innerText=`${r}${e.data.format?e.data.format:"%"}`,universal.send(universal.events.keypress,{isSlider:!0,sliderValue:e.data.value,event:t,btn:e})},m=setInterval((()=>{if(a.dataset.value===e.data.value)return;if(c)return;if(!document.body.contains(a))return void clearInterval(m);e.data.value=a.dataset.value;const t=e.data.min,n=e.data.max,o=e.data.value,s=(o-t)/(n-t)*100;"vertical"===e.data.direction?a.style.background=`linear-gradient(to top, var(--slider-background) ${s}%, var(--slider-foreground) ${s}%)`:a.style.background=`linear-gradient(to right, var(--slider-background) ${s}%, var(--slider-foreground) ${s}%)`;const r=Number.parseFloat(o).toFixed(1);i.innerText=`${r}${e.data.format?e.data.format:"%"}`}),500),p=e=>{a.dataset.dragging=!0,c=!0},h=e=>{a.dataset.dragging=!1,c=!1};s.addEventListener("mousedown",p),s.addEventListener("touchstart",p),s.addEventListener("mouseup",h),s.addEventListener("touchend",h),document.addEventListener("mousemove",(e=>{c&&u(e)})),document.addEventListener("touchmove",(e=>{c&&u(e.touches[0])}));const g=(e.data.value-e.data.min)/(e.data.max-e.data.min)*100;a.style.background=`linear-gradient(to right, var(--slider-background) ${g}%, var(--slider-foreground) ${g}%)`,"vertical"===e.data.direction&&(a.style.background=`linear-gradient(to top, var(--slider-background) ${g}%, var(--slider-foreground) ${g}%)`)}(n,t,a);break;case"text":!function(e,t,n){const a=Object.keys(n)[0];var o;t.innerHTML=`<div class="button-text"><p>${o=a,o.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</div></p>`}(0,t,a)}universal.sendEvent("keyRendered",{keyObject:t,snd:n,sndType:e,rawDat:a})}const l={};let d,c,u,m;function p(){return new Promise(((e,t)=>{universal.CLU("Boot / UI : WARNING!","The boot log style hasn't been updated, and won't be! You may notice a few imperfections."),m.style.scale="1",m.style.display="block",d.style.display="block",c.style.animation="pull-down 0.5s",c.style.display="block"}))}function h(){return new Promise(((e,t)=>{e(!0),m.style.scale="0",d.style.display="none",universal.flags.isEnabled("skip-boot-animation")?(c.style.display="none",window.splashScreen&&window.splashScreen.unsplash()):setTimeout((()=>{m.style.display="none",window.splashScreen&&window.splashScreen.unsplash(),setTimeout((()=>{c.style.animation="pull-up 0.5s",c.querySelector("h1").style.animation="real-fade-out 0.5s",c.querySelector("img").style.animation="real-fade-out 0.5s",setTimeout((()=>{c.style.display="none"}),499)}),200)}),499)}))}function g(){universal.app_sounds=[];try{universal.app_sounds=universal.config.profiles[universal.config.profile]}catch(e){console.log(e)}let e=0;for(let t=0;t<universal.app_sounds.length/universal.config.iconCountPerPage;t++)l[t]=!0,e++;for(const t of universal.app_sounds)t[Object.keys(t)[0]].pos>=e*universal.config.iconCountPerPage&&(l[e]=!0,e++)}function f(){for(const e of document.querySelectorAll(".plugin-view"))e.remove();for(const e in universal.plugins){const t=universal.plugins[e];if(0!==Object.keys(t.views).length)for(const e in t.views){const n=t.views[e],a=document.createElement("div");a.classList.add("plugin-view"),a.classList.add("editor-section"),a.style.display="none",a.id=`plugin-view-${btoa(e).toLowerCase().split("=")[0]}`,(async()=>{const e=await fetch(`/user-data/plugin-views/${t.id}/${n}/view.html`),o=await e.text();a.innerHTML=o;const s=document.createElement("script");s.src=`/user-data/plugin-views/${t.id}/${n}/script.js`,s.type="module",document.body.appendChild(s)})(),document.querySelector("#editor-div").insertBefore(a,document.querySelector(".editor-options"));const o=document.createElement("button");o.innerText=e,o.onclick=()=>{document.querySelector("#none-only").style.display="none";for(const e of document.querySelectorAll(".plugin-view"))e.style.display="none";const t=document.querySelector("#editor-btn"),n=JSON.parse(t.getAttribute("data-interaction"));n.data._view=btoa(e).toLowerCase().split("=")[0],universal.setTileData("_view",btoa(e).toLowerCase().split("=")[0],n),t.setAttribute("data-interaction",JSON.stringify(n)),document.querySelector(`#plugin-view-${btoa(e).toLowerCase().split("=")[0]}`).style.display="block"},document.querySelector(".plugin-view-listing").appendChild(o)}}}function y(){if(universal.lclCfg().fill){const e=document.createElement("style");e.type="text/css",e.id="fill";const t="\n\t\t\t\t#keys .button {\n\t\t\t\twidth: unset; height: unset;\n\t\t\t\t}\n\t\t";e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.head.appendChild(e)}else{const e=document.getElementById("fill");e&&e.remove()}universal.lclCfg().compact?(universal.keys.style.width="unset",universal.keys.style.height="unset"):(universal.keys.style.width="100%",universal.keys.style.height="100%"),universal.config.iconCountPerPage=universal.lclCfg().iconCountPerPage,universal.page=universal.load("page")?Number.parseInt(universal.load("page")):0,g();for(const e of document.querySelectorAll("#keys > .button"))e.remove();if(document.querySelector(".k"))for(const e of document.querySelectorAll(".k"))e.remove();document.querySelector(".cpage")&&(document.querySelector(".cpage").innerText=`${(0,a.rG)("lside.pages.page")}${universal.page+1}/${Object.keys(l).length}`),universal.keySet();for(const e of document.querySelectorAll(".tile-tooltip"))e.remove();for(const e of universal.app_sounds){const t=Object.keys(e)[0],n=e[t];n.plugin&&(n.plugin=n.plugin.toLowerCase());let a=document.querySelector(`.k-${n.pos}`);if(!(n.pos<universal.config.iconCountPerPage*universal.page)){if(!a){if(0===universal.page)continue;const e=n.pos-universal.config.iconCountPerPage*universal.page;n.pos=e,a=document.querySelector(`.k-${n.pos}`),n.pos=e+universal.config.iconCountPerPage*universal.page}try{if(a?.querySelector(".slider-container")&&a.querySelector(".slider-container").remove(),n.pos>=universal.config.iconCountPerPage*(universal.page+1))continue;if(a.setAttribute("data-interaction",JSON.stringify(n)),a.setAttribute("data-name",t),a.classList.remove("unset"),n.data.icon&&(a.style.backgroundImage=`url("${n.data.icon}")`),n.data.color&&(a.style.backgroundColor=n.data.color),n.data.fontSize&&(a.style.fontSize=n.data.fontSize),r(n.type,a,n,e),!n.type.includes("fd.")){if(!universal.plugins[n.plugin]){console.log("plugin missing",n.plugin);const e=document.createElement("div");e.classList.add("indicator-red"),a.appendChild(e)}let e=!1;for(const t of universal._tyc.keys())t.type===n.type&&(e=!0);if(!e&&universal.plugins[n.plugin]){console.log("type missing",n.type);const e=document.createElement("div");e.classList.add("indicator-yellow"),a.appendChild(e)}}const o=universal.app_sounds.filter((e=>{const t=universal.page>0?1:0;return e[Object.keys(e)[0]].pos===n.pos+universal.page*universal.config.iconCountPerPage+t}));if(o.length>1&&a.classList.add("duplicate"),"Companion"!==universal.name)continue;let s="";if(s+=`<h4>${universal.cleanHTML(t,!1)}</h4>`,"text"!==n.renderType?s+="true"===n.data.longPress?"<p>Long press to activate.</p>":"<p>Short press to activate.</p>":s+="<p>Not pressable.</p>",n.plugin){universal.plugins[n.plugin]?s+=`<p>This tile uses ${universal.cleanHTML(universal.plugins[n.plugin].name,!1)}.</p>`:s+=`<p>${universal.cleanHTML(n.plugin,!1)} could not be found.</p>`;for(const e of Array.from(universal._tyc.keys()))if(e.type===n.type){s+=`<code>${e.name}</code>`;break}}"fd.sound"===n.type&&(s+="<p>Plays sound:</p>",s+=`<code>${universal.cleanHTML(n.data.path,!1)}${universal.cleanHTML(n.data.file,!1)}</code>`),"fd.profile"===n.type&&(s+="<p>Opens folder:</p>",s+=`<code>${universal.cleanHTML(n.data.profile,!1)}</code>`),"fd.macro_text"===n.type&&(s+="<p>Types out:</p>",s+=`<code>${universal.cleanHTML(n.data.macro,!1)}</code>`),"fd.macro"===n.type&&(s+="<p>Presses:</p>",s+=`<code>${universal.cleanHTML(n.data.macro,!1)}</code>`),"fd.none"===n.type?s+="<p>Does nothing.</p>":"fd.select"===n.type&&(s+="<p>No plugin selected.</p>"),s+="<p>Right click to edit.</p>",s+=`<details><summary>Advanced (press V)</summary><p>Type: ${n.type}</p><p>Pos: ${n.pos}</p><p>Data size: ${Object.keys(n.data).length}</p></details>`;const i=universal.createTooltipFor(a,s);i.classList.add("tile-tooltip"),window.addEventListener("keydown",(e=>{"v"===e.key&&(i.querySelector("details").open=!i.querySelector("details").open)}))}catch(n){console.log(`while rendering sound: ${t}`,e[t],"on page",universal.page),console.error(n)}}}if(universal.sendEvent("page_change"),"Companion"===universal.name)for(const e of document.querySelectorAll(".unset")){let t="<h4>Nothing!</h4>";t+="<p>Click this space to create a new Tile here.</p>",universal.createTooltipFor(e,t).classList.add("tile-tooltip");const n=Number.parseInt(e.className.split(" ")[1].split("-")[1])+(universal.page<0?1:0)+(universal.page>0?universal.config.iconCountPerPage*universal.page:0),a="fdc."+1e7*Math.random();v.reloadProfile();const o={type:"fd.none",pos:n,uuid:a,data:{}};e.addEventListener("click",(e=>{universal.send(universal.events.companion.new_tile,{"New Tile":o}),universal.listenForOnce("page_change",(()=>{universal.editTile({srcElement:{getAttribute:e=>JSON.stringify(o),dataset:{name:"New Tile",interaction:JSON.stringify(o)},className:"button k-0 k"}})}))}))}}window.RplTest=f;const v={reloadSounds:y,reloadProfile:g,quickActions:function(e){},Pages:l,initialize:function(){universal.CLU("Boot / UI","Initializing UI"),universal.config.iconCountPerPage=Number.parseInt(universal.lclCfg().iconCountPerPage)||12,universal.CLU("Boot / UI","Set icon count"),universal.theming.setTheme(universal.config.theme?universal.config.theme:"default",!1),universal.CLU("Boot / UI","Set local theme"),15!==universal.lclCfg()["font-size"]&&document.documentElement.style.setProperty("--font-size",`${universal.lclCfg()["font-size"]}px`),universal.CLU("Boot / UI","Set font size"),y(),universal.CLU("Boot / UI","Reloaded sounds"),universal.CLU("Boot / UI","UI initialized"),universal.showBootLog=p,universal.closeBootLog=h},makeBootLog:function(){const e=document.createElement("div");e.id="boot-log-div",e.innerHTML="<img src='/logo_big.png' class='n-icon'><h1>Freedeck</h1><div style='display:none;' id='boot-log'><center class='oclb'><button id='oclb'>Close Boot Log</button><button onclick='universal.storage.reset()'>Reset Storage</button></center></div>",document.body.appendChild(e),c=e,u=document.querySelector("#boot-log-div > center"),m=document.querySelector("#boot-log"),m.style.display="none",e.addEventListener("click",(()=>{m.style.display="block"})),e.addEventListener("touchstart",(()=>{m.style.display="block"})),d=document.querySelector("#oclb"),d.style.display="none",d.addEventListener("click",(()=>{h()}))},closeBootLog:h,showBootLog:p,visual:{idChangeText:function(e,t){for(const n of document.querySelectorAll(".button"))n.getAttribute("data-interaction")&&JSON.parse(n.getAttribute("data-interaction")).uuid===e&&"editor-btn"!==n.id&&(n.querySelector(".button-text p").innerText=t)},typeChangeText:function(e,t){for(const n of document.querySelectorAll(".button"))n.getAttribute("data-interaction")&&JSON.parse(n.getAttribute("data-interaction")).type===e&&"editor-btn"!==n.id&&(n.querySelector(".button-text p").innerText=t)}},makeGenericModal:function(e,t,n,a,o="",s=!1){const i=document.createElement("div");i.classList.add("modal"),i.innerHTML=`<div class="modalContent"><div class="modal-header"><h2 class="modal-title" style="text-align:left;">${e}</h2><span class="close modal-close">&times;</span></div><div class="modal-body"><p class="modal-description" style="text-align:left;width:100%;">${t}</p>${o}</div><div class="modal-footer"></div></div>`;const r=i.querySelector(".modal-footer");a||(i.querySelector(".modal-close").style.display="none");for(const e of n){const t=document.createElement("button");t.innerText=e.text,t.onclick=e.onclick,r.appendChild(t)}return document.body.appendChild(i),i.querySelector(".close").onclick=()=>{if(s)return i.classList.add("closing"),i.querySelector(".modal-body").classList.add("closing"),void setTimeout((()=>{i.style.display="none"}),250);i.classList.add("closing"),i.querySelector(".modal-body").classList.add("closing"),setTimeout((()=>{i.remove()}),250)},{modal:i,content:i.querySelector(".modal-body"),close:()=>{i.classList.add("closing"),i.querySelector(".modal-body").classList.add("closing"),setTimeout((()=>{i.remove()}),250)},hide:()=>{i.classList.add("closing"),i.querySelector(".modal-body").classList.add("closing"),setTimeout((()=>{i.style.display="none"}),250)},forceHide:()=>{i.style.display="none"},show:()=>{i.classList.remove("closing"),i.querySelector(".modal-body").classList.remove("closing"),i.style.display="flex"}}},reloadPluginViews:f}},363:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=class{types;view;onRun;onFirstSetup;constructor(e,...t){this.types=t,this.view=e,this.onRun=()=>{},this.onFirstSetup=()=>{}}setOnRun(e){this.onRun=e}setOnFirstSetup(e){this.onFirstSetup=e}forwardRunningEvent(e,t,...n){let a=!1;return this.types.includes(e)&&(console.log("RUNNING",n,e),a=!0,t(),this.run(...n)),a}run(...e){this.onRun(...e)}firstSetup(){this.onFirstSetup()}}},367:(e,t,n)=>{var a={"./Client.js":[172,172],"./CurrentPage.js":[161,161],"./Footer.js":[51,432],"./MobileDevice.js":[779,779],"./Profiles.js":[621,621],"./SidebarLoader.js":[44],"./Soundboard.js":[398,398],"./Style.js":[366,366]};function o(e){if(!n.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(o)))}o.keys=()=>Object.keys(a),o.id=367,e.exports=o},400:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(363),o=n(403);const s=document.querySelector("#editor-btn"),i=document.querySelector("#system-select"),r=document.querySelector("#type");class l extends a.A{constructor(){super("system","fd.sys.volume","fd.sys.volume.sys"),this.setOnRun((({interactionData:e})=>{universal.nbws.send("get_apps",""),universal.nbws.once("apps",(t=>{const n=t,a=JSON.parse(s.getAttribute("data-interaction"));i.innerHTML="";for(const e of n){const t=document.createElement("option");let n=""!==e.friendly?`${e.friendly} (${e.name})`:e.name;"_fd.System"===e.name&&(n="System Volume"),t.innerText=n,t.value=e.name,a.data?.app&&a.data.app===e.name&&(t.selected=!0),i.appendChild(t)}i.onchange=e=>{const t="_fd.System"!==e.srcElement.value?"fd.sys.volume":"fd.sys.volume.sys";r.value=t,a.type=t,a.renderType="slider",(0,o.Nr)("app",e.srcElement.value,a),(0,o.Nr)("min",0,a),(0,o.Nr)("max",100,a),(0,o.Nr)("value",50,a),(0,o.Nr)("format","%",a),(0,o.Nr)("direction","vertical",a),s.setAttribute("data-interaction",JSON.stringify(a))},e.type.startsWith("fd.sys.volume")&&(i.value=e.data.app)}))})),this.setOnFirstSetup((()=>{universal.nbws.send("get_apps","");const e=JSON.parse(s.getAttribute("data-interaction"));e.type="fd.sys.volume.sys",e.renderType="slider",e.data.app="_fd.System",e.data.min=0,e.data.max=100,e.data.value=50,e.data.format="%",e.data.direction="vertical",s.setAttribute("data-interaction",JSON.stringify(e)),r.value="fd.sys.volume.sys"}))}}const d=l},403:(e,t,n)=>{"use strict";n.d(t,{Nr:()=>i,Ze:()=>s,ci:()=>r});const a=document.querySelector("#editor-data"),o=document.querySelector("#system-select");function s(e){a.innerHTML="",o.innerHTML="";for(const t of Object.keys(e)){const n=document.createElement("input");n.type="text",n.placeholder=t,n.value=e[t],n.className="editor-data",n.id=t;const o=document.createElement("label");o.class="editordata-removable",o.innerText=t,o.appendChild(n),a.appendChild(o)}}function i(e,t,n){if(document.querySelector(`.editor-data#${e}`))document.querySelector(`.editor-data#${e}`).value=t;else{const n=document.createElement("input");n.type="text",n.placeholder=e,n.value=t,n.className="editor-data",n.id=e;const a=document.createElement("label");a.class="editordata-removable",a.innerText=e,a.appendChild(n),document.querySelector("#editor-data").appendChild(a)}n.data[e]=t}function r(){const e={};for(const t of document.querySelectorAll(".editor-data"))e[t.id]=t.value;return e}universal.loadEditorData=s,universal.setTileData=i},416:(e,t,n)=>{"use strict";n.a(e,(async(e,t)=>{try{var a=n(340),o=n(669),s=n(424),i=n(403),r=(n(863),n(806),n(295),n(15),n(661),n(432)),l=n(850),d=n(400),c=n(363),u=n(241),m=n(332);n(951),await o.m.init("Companion"),o.m.connectionTest=!0;const p=document.querySelector("#editor-btn"),h=document.querySelector("#editor"),g=document.querySelector("#editor-div"),f=document.querySelector(".sidebar"),y=document.querySelector(".toggle-sidebar"),v=document.querySelector(".toggle-sidebar button");v.onclick=e=>{"flex"===f.style.display?(e.target.dataset.nosound||o.m.uiSounds.playSound("slide_close"),f.style.animation="sidebar-slide-out 0.5s",f.style.animationFillMode="forward",v.style.transform="rotate(0deg)",y.style.left="0",setTimeout((()=>{f.style.display="none"}),500)):(e.target.dataset.nosound||o.m.uiSounds.playSound("slide_open"),f.style.display="flex",f.style.animation="sidebar-slide-in 0.5s",v.style.transform="rotate(180deg)",y.style.left="calc(11.5%)")};const _=new Map([["audio",new l.A],["system",new d.A],["plugin",new c.A],["macro",new u.A],["profile",new m.A],["none",new c.A]]);function b(e){o.m.uiSounds.playSound("editor_open");const t=JSON.parse(e.srcElement.getAttribute("data-interaction"));p.dataset.state="init",o.m.keys.classList.add("smaller");for(const e of document.querySelectorAll(".k"))e.classList.add("smaller"),e.classList.add("blur");document.querySelector(`.k[data-interaction='${e.srcElement.getAttribute("data-interaction")}']`).classList.remove("smaller"),document.querySelector(".contextMenu")&&(document.querySelector(".contextMenu").style.display="none");for(const e of document.querySelectorAll(".plugin-view"))e.style.display="none";document.querySelector("#advanced-view").style.display="none",h.style.display="block",p.setAttribute("data-pre-edit",e.srcElement.dataset.name),p.setAttribute("data-interaction",e.srcElement.getAttribute("data-interaction"));for(const e of document.querySelectorAll(".spiaction"))e.style.display="none",e.classList.remove("spi-active"),t.plugin&&e.dataset.plugin===t.plugin&&(e.dataset.type===t.type&&e.classList.add("spi-active"),e.style.display="block");if("Freedeck"!==t.plugin&&t.plugin?(document.querySelector('label[for="plugin"]').style.display="block",document.querySelector("#plugin").style.display="block",document.querySelector("#plugin").value=t.plugin||"Freedeck"):(document.querySelector("#plugin").style.display="none",document.querySelector('label[for="plugin"]').style.display="none"),document.querySelector("#editor-back").style.display="block",(0,s.S)(),document.querySelector(".spi-actions-disabled").style.display="none",document.querySelector(".spi-actions-notfound").style.display="none",t.type.startsWith("fd.")){for(const e of document.querySelectorAll(".spiaction, .spiback"))e.style.display="none";for(const e of document.querySelectorAll(".spiplugin"))e.style.display="block"}else{for(const e of document.querySelectorAll(".spiaction"))e.classList.contains(`pl-${t.plugin}`)&&(e.style.display="block");for(const e of document.querySelectorAll(".spiback"))e.style.display="block";for(const e of document.querySelectorAll(".spiplugin"))e.style.display="none";for(const e of document.querySelectorAll(".spi-actions-disabled-id"))e.innerText=t.plugin;for(const e of document.querySelectorAll(".spi-actions-notfound-type"))e.innerText=t.type;document.querySelector(`.spi[data-type="${t.type}"]`)||(document.querySelector(".spi-actions-notfound").style.display="block"),void 0===o.m.plugins[t.plugin]&&(document.querySelector(".spi-actions-disabled").style.display="block"),(0,s.d)("plugins")}if("fd.none"!==t.type||t.data._view)for(const e of _)e[1].forwardRunningEvent(t.type,(()=>{(0,s.d)(e[1].view)}),{interactionData:t});else(0,s.d)("none"),document.querySelector("#editor-back").style.display="none";if(t.plugin&&S(t.plugin),t.data){const e=t.data;(0,i.Ze)(e)}document.querySelector("#sbg").style.display="button"===t.renderType?"block":"slider"===t.renderType?"none":"block",document.querySelector('label[for="sbg"]').style.display="button"===t.renderType?"block":"slider"===t.renderType?"none":"block",w("#orl","onRelease",t),w("#lp","longPress",t),w("#sbg","showBg",t),w("#nbo","noBorder",t),w("#nbr","noRounding",t),w("#nsh","noShadow",t),document.querySelector("#lp").style.display="slider"===t.renderType?"none":"block",document.querySelector('label[for="lp"]').style.display="slider"===t.renderType?"none":"block",g.style.animationName="editor-pull-down",o.m.keys.parentElement.style.transform="translate(-50%, -115%)",v.style.display="none",o.m.sendEvent("editTile",t,e.srcElement.dataset.name)}function w(e,t,n){document.querySelector(e).checked="true"===n.data[t]}function k(e,t){document.querySelector(e).addEventListener("click",(n=>{const a=JSON.parse(p.getAttribute("data-interaction"));a.data[t]?a.data[t]=!a.data[t]:a.data[t]=!0,p.setAttribute("data-interaction",JSON.stringify(a)),(0,i.Ze)(a.data),document.querySelector(e).checked=a.data[t]}))}o.m.editTile=b,document.querySelector("#editor-back").onclick=()=>{document.querySelector("#editor-back").style.display="none",(0,s.d)("none")},k("#sbg","showBg"),k("#nbo","noBorder"),k("#nbr","noRounding"),k("#nsh","noShadow"),k("#orl","onRelease"),k("#lp","longPress"),document.querySelector("#change-pl-settings").onclick=()=>{const e=document.querySelector("#plugin").value,t={};for(const e of document.querySelectorAll(".pl-settings-item")){const n=e.querySelector("div").innerText;if(e.querySelector(".pl-settings-array")){const a=[];for(const t of e.querySelectorAll(".pl-settings-array input"))a.push(t.value);t[n]=a}else t[n]=e.querySelector("input").value}o.m.send(o.m.events.companion.plugin_set_all,{plugin:e,settings:t})};const S=e=>{const t=document.querySelector("#pl-settings");if(t.innerHTML="",document.querySelector("#pl-title").innerText="Plugin Settings",!o.m.plugins[e])return t.innerHTML="<h2>The plugin for this Tile is missing.</h2><p>Please re-enable or download it.</p>",void(document.querySelector("#change-pl-settings").style.display="none");document.querySelector("#change-pl-settings").style.display="block",document.querySelector("#pl-title").innerText=`${o.m.plugins[e].name} Settings`;const n=o.m.plugins[e].Settings;for(const e of Object.keys(n)){const a=n[e],o=document.createElement("div");o.classList.add("pl-settings-item");const s=document.createElement("div");if(s.innerText=e,o.appendChild(s),Array.isArray(a)||"object"==typeof a){const t=document.createElement("div");t.classList.add("pl-settings-array");let n=0;for(const o of a){const a=document.createElement("input");a.type="password"!==e||"token"!==e?"text":"password",a.id=e,a.dataset.index=n,a.value=o,t.appendChild(a),n++}o.appendChild(t)}else{const t=document.createElement("input");t.type="password"!==e||"token"!==e?"text":"password",t.id=e,t.value=a,o.appendChild(t)}t.appendChild(o)}},x=()=>{const e=document.querySelector("#eprofile-select");e.innerHTML="";for(const t of Object.keys(o.m.config.profiles)){const n=document.createElement("option");n.innerText=t,n.value=t,e.appendChild(n)}e.onchange=e=>{const t=JSON.parse(p.getAttribute("data-interaction"));t.data.profile=e.srcElement.value,p.setAttribute("data-interaction",JSON.stringify(t)),(0,i.Ze)(t.data)}};o.m.generateProfileSelect=x,document.querySelector("#spiback").onclick=e=>{document.querySelector(".spi-actions-disabled").style.display="none";for(const e of document.querySelectorAll(".spiaction, .spiback"))e.style.display="none";for(const e of document.querySelectorAll(".spiplugin"))e.style.display="block"},document.querySelector("#spiav").onclick=()=>{const e=JSON.parse(p.getAttribute("data-interaction"));e.data&&0!==Object.keys(e.data).length?document.querySelector("#tiledata").style.display="flex":document.querySelector("#tiledata").style.display="none","block"===document.querySelector("#advanced-view").style.display?document.querySelector("#advanced-view").style.display="none":document.querySelector("#advanced-view").style.display="block"};const C=document.querySelector("#spi-actions");for(const O of o.m._tyc.keys()){if(!document.querySelector(`.rpl-${O.pluginId}`)){if(O.hidden)continue;const z=document.createElement("div");z.classList.add(`rpl-${O.pluginId}`),z.classList.add("plugin-item"),z.classList.add("spi"),z.classList.add("spiplugin"),z.innerText=O.display,z.onclick=e=>{for(const e of document.querySelectorAll(`.spiaction.pl-${O.pluginId}`))e.style.display="block";for(const e of document.querySelectorAll(".spiback"))e.style.display="block";for(const e of document.querySelectorAll(".spiplugin"))e.style.display="none"},C.appendChild(z)}const $=document.createElement("div");$.classList.add(`pl-${O.pluginId}`),$.classList.add("plugin-item"),$.classList.add("spi"),$.classList.add("spiaction"),$.setAttribute("data-type",O.type),$.setAttribute("data-plugin",O.pluginId),$.setAttribute("data-rt",O.renderType),$.setAttribute("data-template",JSON.stringify(O.templateData)),$.innerText=`${O.display}: ${O.name}`,$.onclick=e=>{const t=JSON.parse(p.getAttribute("data-interaction")),n=e.target.getAttribute("data-type"),a=e.target.getAttribute("data-plugin"),o=e.target.getAttribute("data-rt"),s=JSON.parse(e.target.getAttribute("data-template"));t.plugin&&document.querySelector(`.spi[data-type="${t.type}"][data-plugin="${t.plugin}"]`)&&document.querySelector(`.spi[data-type="${t.type}"][data-plugin="${t.plugin}"]`).classList.remove("spi-active"),t.type=n,t.plugin=a,t.renderType=o,t.data={...t.data,...s},document.querySelector(`.spi[data-type="${n}"][data-plugin="${a}"]`).classList.add("spi-active"),p.setAttribute("data-interaction",JSON.stringify(t)),document.querySelector("#type").value=n,document.querySelector("#plugin").value=a,(0,i.Ze)(t.data),S(t.plugin)},C.appendChild($)}function E(e){"icon"===e?(document.querySelector("#library-view-sounds").style.display="none",document.querySelector("#library-view-icons").style.display="block",document.querySelector("#library-view-sounds").open=!1,document.querySelector("#library-view-icons").open=!0,document.querySelector(".uploads-0").style.display="none",document.querySelector("#uploads-0-title").style.display="none",document.querySelector(".uploads-1").style.display="flex",document.querySelector("#uploads-1-title").style.display="block",document.querySelector("#library > body> center p").textContent="Select an icon to use, or upload a new one!",document.querySelector("#library > body> h1").textContent="Available Icons",document.querySelector(".save-changes").style.display="block"):"sound"===e?(document.querySelector("#library-view-sounds").style.display="block",document.querySelector("#library-view-icons").style.display="none",document.querySelector("#library-view-sounds").open=!0,document.querySelector("#library-view-icons").open=!1,document.querySelector(".uploads-0").style.display="flex",document.querySelector("#uploads-0-title").style.display="block",document.querySelector(".uploads-1").style.display="none",document.querySelector("#uploads-1-title").style.display="none",document.querySelector("#library > body> center p").textContent="Select an sound to use, or upload a new one!",document.querySelector("#library > body> h1").textContent="Available Sounds",document.querySelector(".save-changes").style.display="block"):(document.querySelector("#library-view-sounds").style.display="block",document.querySelector("#library-view-icons").style.display="block",document.querySelector("#library-view-sounds").open=!1,document.querySelector("#library-view-icons").open=!1,document.querySelector(".uploads-0").style.display="flex",document.querySelector("#uploads-0-title").style.display="block",document.querySelector(".uploads-1").style.display="flex",document.querySelector("#uploads-1-title").style.display="block",document.querySelector("#library > body> center p").textContent="Here you will find every sound or icon you've uploaded.",document.querySelector("#library > body> h1").textContent="Library",document.querySelector(".save-changes").style.display="none")}function L(e,t,n){const a=document.createElement("div");a.className="modal";const o=document.createElement("div");o.className="modalContent";const s=document.createElement("button");s.innerText="Close",s.classList.add("modalClose"),s.onclick=()=>{a.remove()},o.appendChild(s);const i=document.createElement("h2");i.innerText=e,i.classList.add("modalTitle"),o.appendChild(i);const r=document.createElement("div");r.classList.add("modalFeedback"),o.appendChild(r);const l=document.createElement("input");l.type="text",l.placeholder=t,l.classList.add("modalInput_text"),o.appendChild(l);const d=document.createElement("button");d.innerText="Save",d.onclick=()=>{!1!==n(a,l.value,r,i,d,l,o)&&a.remove()},o.appendChild(d),a.appendChild(o),document.body.appendChild(a)}function q(e,t,n,a=!0){const s=document.createElement("div");s.className="modal";const i=document.createElement("div");if(i.classList.add("modalContent"),a){const e=document.createElement("button");e.innerText="Close",e.classList.add("modalClose"),e.onclick=()=>{s.remove()},i.appendChild(e)}const r=document.createElement("h2");r.innerText=e,r.classList.add("modalTitle"),i.appendChild(r);const l=document.createElement("div");l.innerText=t,l.classList.add("modalTextContent"),i.appendChild(l);const d=document.createElement("button");return d.innerText="Next",d.onclick=()=>{s.remove(),n()},i.appendChild(d),s.appendChild(i),document.body.appendChild(s),o.m.uiSounds.playSound("int_prompt"),s}function T(e,t,n,s="",i=!0){const r=document.createElement("div");r.classList.add("modalFeedback");const l=document.createElement("select");l.className="modalList",l.style.marginBottom="20px";const d=a.UI.makeGenericModal(e,s,[{text:"Save",onclick:()=>{const e=l.options[l.selectedIndex],t=JSON.parse(e.value);!1!==n({modal:d,value:t,modalFeedback:r,modalContent:c})&&d.close()}}],i),c=d.content;c.appendChild(r),c.appendChild(l);for(const e of t){const t=document.createElement("option");t.className="modalItem",t.setAttribute("value",JSON.stringify(e)),t.innerText=e.name||e.display,l.appendChild(t)}return document.body.appendChild(d.modal),o.m.uiSounds.playSound("int_prompt"),d}function A(e,t,n,a=!0){const s=o.m.UI.makeGenericModal(e,t,[],a),i=s.content,r=document.createElement("div");r.classList.add("flex-wrap-r");const l=document.createElement("button");return l.innerText="Proceed",l.onclick=()=>{s.close(),n()},r.appendChild(l),i.appendChild(r),document.body.appendChild(s.modal),o.m.uiSounds.playSound("int_confirm"),s}x(),document.querySelector("#upload-sound").onclick=()=>{document.querySelector("#upload-sound").disabled=!0,o.m.uiSounds.playSound("int_confirm");const e=JSON.parse(p.dataset.interaction);o.m._Uploads_View=0,o.m.vopen("library"),o.m._libraryOnload=()=>{E("sound")},o.m._libraryOnpaint=()=>{e.data.file&&document.querySelector(`.upload[data-name='${e.data.file}']`)&&document.querySelector(`.upload[data-name='${e.data.file}']`).classList.add("glow");for(const e of document.querySelectorAll(".uploads-0 .upload"))e.onclick=()=>{for(const e of document.querySelectorAll(".upload"))e.classList.remove("glow");e.classList.add("glow"),o.m._Uploads_Select(e.dataset.name)};document.querySelector(".save-changes").onclick=()=>{o.m._libraryOnload=()=>{E("")},o.m._libraryOnpaint=void 0,o.m.vopen("index.html")}},o.m._Uploads_Select=e=>{const t=JSON.parse(p.getAttribute("data-interaction"));t.data.file=e,t.data.path="/sounds/",p.setAttribute("data-interaction",JSON.stringify(t)),(0,i.Ze)(t.data),document.querySelector("#file.editor-data").value=e,document.querySelector("#path.editor-data").value="/sounds/",document.querySelector("#audio-file").innerText=e,o.m.uiSounds.playSound("int_yes")}},_.forEach(((e,t)=>{console.log("Setting up",t),document.querySelector(`#none-${t}`)&&(document.querySelector(`#none-${t}`).onclick=n=>{n.preventDefault(),(0,s.d)(t),e.onFirstSetup({interactionData:JSON.parse(p.getAttribute("data-interaction"))})})})),o.m.nbws.on("apps",(e=>{const t=e,n=JSON.parse(p.getAttribute("data-interaction")),a=document.querySelector("#system-select");a.innerHTML="";for(const e of t){const t=document.createElement("option");let o=""!==e.friendly?`${e.friendly} (${e.name})`:e.name;"_fd.System"===e.name&&(o="System Volume"),t.innerText=o,t.value=e.name,n?.data?.app&&n.data.app===e.name&&(t.selected=!0),a.appendChild(t)}a.onchange=e=>{const t=JSON.parse(p.getAttribute("data-interaction")),n="_fd.System"!==e.srcElement.value?"fd.sys.volume":"fd.sys.volume.sys";document.querySelector("#type").value=n,t.type=n,t.renderType="slider",(0,i.Nr)("app",e.srcElement.value,t),(0,i.Nr)("min",0,t),(0,i.Nr)("max",100,t),(0,i.Nr)("value",50,t),(0,i.Nr)("format","%",t),(0,i.Nr)("direction","vertical",t),p.setAttribute("data-interaction",JSON.stringify(t))}})),document.querySelector("#macro-macro").onchange=e=>{const t=JSON.parse(p.getAttribute("data-interaction"));(0,i.Nr)("macro",e.srcElement.value,t),t.data.macro=e.srcElement.value},document.querySelector("#macro-type").onchange=e=>{const t=JSON.parse(p.getAttribute("data-interaction"));t.type="text"===e.srcElement.value?"fd.macro_text":"fd.macro",document.querySelector("#type").innerText=t.type,p.setAttribute("data-interaction",JSON.stringify(t))},document.querySelector("#none-plugin").onclick=e=>{document.querySelector('label[for="plugin"]').style.display="block",document.querySelector("#plugin").style.display="block";const t=JSON.parse(p.getAttribute("data-interaction"));t.type="fd.select",document.querySelector("#type").innerText="fd.select",p.setAttribute("data-interaction",JSON.stringify(t)),(0,s.d)("plugins")},document.querySelector("#upload-icon").onclick=e=>{o.m.uiSounds.playSound("int_confirm"),o.m._Uploads_View=1,o.m.vopen("library");const t=JSON.parse(p.dataset.interaction);o.m._libraryOnload=()=>{E("icon")},o.m._libraryOnpaint=()=>{t.data.icon&&document.querySelector(`.upload[data-name='${t.data.icon.split("/icons/")[1]}']`)&&document.querySelector(`.upload[data-name='${t.data.icon.split("/icons/")[1]}']`).classList.add("glow");for(const e of document.querySelectorAll(".uploads-1 .upload"))e.onclick=()=>{for(const e of document.querySelectorAll(".upload"))e.classList.remove("glow");e.classList.add("glow"),o.m._Uploads_Select(e.dataset.name)};document.querySelector(".save-changes").onclick=()=>{o.m._libraryOnload=()=>{E("")},o.m._libraryOnpaint=void 0,o.m.vopen("index.html")}},o.m._Uploads_Select=e=>{const t=JSON.parse(p.getAttribute("data-interaction"));t.data.icon=`/icons/${e}`,p.setAttribute("data-interaction",JSON.stringify(t)),p.style.backgroundImage=`url("/icons/${e}")`,(0,i.Ze)(t.data),o.m.uiSounds.playSound("uploaded")}},window.UniversalUI={show:{showEditModal:L,showPick:T,showText:q}},window.onclick=e=>{"contextMenu"!==e.srcElement.className&&document.querySelector(".contextMenu")&&document.querySelector(".contextMenu").remove(),o.m.uiSounds.playSound("click")},document.addEventListener("keydown",(e=>{"not"==p.dataset.state&&("ArrowLeft"===e.key&&a.UI.Pages[o.m.page-1]&&(o.m.page--,o.m.save("page",o.m.page),o.m.uiSounds.playSound("page_down"),a.UI.reloadSounds(),o.m.sendEvent("page_change"),o.m.sendEvent("animate_page")),"ArrowRight"===e.key&&a.UI.Pages[o.m.page+1]&&(o.m.page++,o.m.save("page",o.m.page),o.m.uiSounds.playSound("page_up"),a.UI.reloadSounds(),o.m.sendEvent("page_change"),o.m.sendEvent("animate_page")))}));const I=o.m.load("now-editing");I&&setTimeout((()=>{const e=o.m.app_sounds.filter((e=>e[Object.keys(e)[0]].uuid===I))[0];e&&b({srcElement:{getAttribute:t=>JSON.stringify(e[Object.keys(e)[0]]),dataset:{name:Object.keys(e)[0],interaction:JSON.stringify(e[Object.keys(e)[0]])},className:"button k-0"}}),o.m.remove("now-editing")}),250),"false"===o.m.load("has_setup")&&(o.m.ctx.destructiveView("setup"),document.querySelector(o.m.ctx.view_container).style.display="block",f.style.display="none"),o.m.on(o.m.events.user_mobile_conn,(e=>{"false"!==o.m.load("has_setup")&&(o.m.waitForElement(".mobd",(t=>{t.style.display=e?"none":"flex"})),o.m.uiSounds.playSound(`mobile_${e?"":"dis"}connect`))})),o.m._information.mobileConnected&&o.m.waitForElement(".mobd",(e=>{e.style.display="none"}));const N=o.m.lclCfg();let U="repeat(5, 2fr)";N.tileCols&&(U=U.replace("5",N.tileCols)),document.documentElement.style.setProperty("--tile-columns",U),o.m.listenFor("audio-end",(e=>{const t=e.name.replace(/[^a-zA-Z0-9]/g,"");document.querySelector(`.s-${t}`)&&document.querySelector(`.s-${t}`).remove()})),window.showPick=T,window.showText=q,window.showYesNo=A,window.showEditModal=L,(0,r.k)(!1),t()}catch(D){t(D)}}),1)},424:(e,t,n)=>{"use strict";n.d(t,{S:()=>r,d:()=>i});var a=n(656);const o=document.querySelector("#editor-btn"),s=["audio","plugins","system","none","profile","macro"],i=e=>{for(const e of s)document.querySelector(`#${e}-only`).style.display="none";(0,a.ih)(),document.querySelector(`#${e}-only`).style.display="flex",o.dataset.state=`o ${e}`},r=()=>{for(const e of s)document.querySelector(`#${e}-only`).style.display="none";o.dataset.state="c"}},432:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});const a=JSON.parse('{"eR":["**Introducing 2 new macro types: Application Volume and Macro (BETA)!!**",["Application Volume: This macro type allows you to control the volume of a specific application on your computer. This is useful for when you want to control the volume of a specific application without affecting the system volume.","Macro (BETA): This macro type allows you to create a macro that can either type text, or press individual keys."],"**You are now able to use multiple audio devices at once!**","**A lot of views have gotten a visual refresh! Notice more icons, better colors, and more!**","**Some experiments from Settings have been moved to the main settings page!** These states have not been lost.","**The splash screen has been improved!** The transition now feels much better, and there\'s a progress bar!","**The editor has gotten a better redesign!** Everything feels modern, and the main content sticks out better.","**Added support for .fdpackage bundles!** These are like .Freedeck files, but much, much smaller AND can now be used for themes!","**Added support for Marketplace V3!** The old marketplace will not receive any new updates.","**You can now reload and disable single plugins!**","**Plugin [re]loading has been reworked and is now more efficient.**","**NativeBridge support has been added. Keeping the Freedeck App (launcher) open in the background will allow you to control your computer with Freedeck like never before.**","Official badges have been added to official Marketplace plugins!","The splash screen is now fast, has a progress bar, and now has a smooth transition!","The sidebar has once again, gotten a few more design improvements!","A lot of UI elements have now gotten a border!"],"F":["Fixed an issue where the UI would not size or load properly.","Fixed the issue where after selecting a Library upload, grid dragging would not work","This changelog dialog is now scrollable!","This changelog dialog can no longer be bypassed","Fixed a bug where opening the plugin-type selector will cause the previously selected type to still be highlighted","Fixed a bug where the plugin-type selector wouldn\'t work at all","(WIP, but works) **Plugins can now add Editor views!**"],"eO":[]}'),o=(e=!1)=>{if(!e){if(universal.load("thanks")===universal._information.version.raw)return;if("false"===universal.load("has_setup"))return}const{eR:t,F:n,eO:o}=a,r=universal.UI.makeGenericModal("Thank you for using Freedeck!","A lot has changed since the previous update, so here are the changes.",[]);r.modal.id="thanks";const l=r.content,d=document.createElement("button");d.onclick=()=>{universal.uiSounds.playSound("welcome"),universal.save("thanks",universal._information.version.raw),r.close()},d.innerText="OK";const c=document.createElement("details"),u=document.createElement("summary");u.innerText="Major Changes",c.appendChild(u);const m=document.createElement("ul");for(const e of t)if(Array.isArray(e))i(e,m);else{const t=document.createElement("li");t.innerHTML=s(e),m.appendChild(t)}c.appendChild(m),l.appendChild(c);const p=document.createElement("details"),h=document.createElement("summary");h.innerText="Other Changes",p.appendChild(h);const g=document.createElement("ul");for(const e of n){const t=document.createElement("li");t.innerHTML=s(e),g.appendChild(t)}p.appendChild(g),l.appendChild(p);const f=document.createElement("details"),y=document.createElement("summary");y.innerText="Known Issues",f.appendChild(y);const v=document.createElement("ul");for(const e of o){const t=document.createElement("li");t.innerHTML=s(e),v.appendChild(t)}f.appendChild(v),l.appendChild(f);const _=document.createElement("br");l.appendChild(_);const b=document.createElement("a");b.href="https://discord.gg/7gWrgyt7Aa",b.target="_blank",b.innerText="Join our Discord!",l.appendChild(b);const w=document.createElement("br");l.appendChild(w);const k=document.createElement("p");k.innerText=`Welcome to ${universal._information.version.human}.`,l.appendChild(k);const S=document.createElement("br");l.appendChild(S),l.appendChild(d),document.body.appendChild(r.modal),document.querySelector(".modal-title").style.textAlign="center",document.querySelector(".modal-title").style.width="100%",document.querySelector(".modal-description").style.textAlign="center"},s=e=>e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"),i=(e,t)=>{for(const n in e){const a=document.createElement("ul");if("object"==typeof e[n]){const t=document.createElement("details"),o=document.createElement("summary");o.innerText=n,t.appendChild(o);const s=document.createElement("ul");i(e[n],s),t.appendChild(s),a.appendChild(t)}else{const t=document.createElement("li");t.innerHTML=s(e[n]),a.appendChild(t)}t.appendChild(a)}};window._makeThanks=o},656:(e,t,n)=>{"use strict";n.d(t,{ih:()=>i,lE:()=>s,rG:()=>r});const a=localStorage.getItem("freedeck:locale")||"en";localStorage.getItem("freedeck:locale")||localStorage.setItem("freedeck:locale",a);let o={"locale.display":"English","sidebar.Tiles":"Tiles","sidebar.Library":"Library","sidebar.Marketplace":"Marketplace","sidebar.Settings":"Settings","sidebar.Connect":"Connect","sidebar.Recompile":"Recompile","sidebar.Setup":"Setup","sidebar.Pair Device":"Pair Device","sidebar.Themer":"Themer","lside.mobd":"Mobile Device","lside.mobd.pair":"Pair Mobile Device","lside.pages.page":"Page: ","lside.pages.try":"Try Tiles","lside.pages.previous":"Previous Page","lside.pages.next":"Next Page","lside.footer.thanks":"Thank you for using Freedeck!","lside.footer.github_pre":"Freedeck is open-source and can be found on","lside.footer.need_help":"Need help?","lside.footer.need_help.wiki":"Check the Wiki!","editor.sections.no_action":"No Action!","settings.title":"Settings","settings.sections.style":"Style","settings.sections.style.compact":"Compact Mode","settings.sections.style.scroll":"Scroll Long Text","settings.sections.style.fill":"Fill Tiles","settings.sections.style.themes":"Themes","settings.sections.language":"Language","settings.sections.plugins":"Plugins","settings.sections.plugins.reload_all":"Reload All Plugins","settings.sections.plugins.single.disable":"Disable","settings.sections.plugins.single.reload":"Reload","settings.sections.plugins.disabled.title":"Disabled Plugins","settings.sections.plugins.disabled.enable":"Enable","settings.sections.plugins.tile_previews":"Tile Previews","settings.sections.audio_devices":"Audio Devices","settings.sections.audio_devices.monitor":"Monitor Devices","settings.sections.audio_devices.vb":"VB-Cable Devices","settings.sections.general":"General","settings.sections.general.dont_ask":"Don't ask to delete Tiles","settings.sections.general.fdc_tab":"Show FDConnect as a tab","settings.sections.general.ui_sounds":"UI Sounds","settings.sections.general.center_mode":"Center Mode","settings.sections.experiments":"Experiments","settings.sections.uis":"UI Sounds","settings.sections.uis.soundpacks":"Soundpacks","settings.sections.uis.soundpacks.current":"Current Soundpack","settings.sections.bug":"Bug Report","settings.sections.bug.request_generate":'Click "Generate Report"',"settings.sections.bug.generate":"Generate Report","settings.sections.bug.report_reader":"Report Reader","settings.sections.bug.report_reader.read":"Read Report","settings.footer.by":"is a project by"};function s(){}function i(e=document){console.log("translating page",e)}function r(e,t="{{key}} not found in locale."){void 0===o[e]&&(console.warn(`Translation key ${e} not found in locale.`),0===Object.keys(o).length&&(console.warn("No translations loaded."),async function(){}()));const n=t.replace("{{key}}",e);return o[e]||n}},661:(e,t,n)=>{"use strict";var a=n(669),o=n(340);window.oncontextmenu=e=>{const t=document.querySelector(".contextMenu");if(t&&t.remove(),!e.srcElement.classList.contains("button"))return!1;if(e.srcElement.classList.contains("builtin"))return!1;if(!e.srcElement.classList.contains("k"))return!1;const n=document.createElement("div");n.className="contextMenu",n.style.top=e.clientY-window.scrollY+"px",n.style.left=e.clientX-window.scrollX+"px",n.style.position="absolute",void 0===e.srcElement.dataset.name&&(e.srcElement.dataset.name="");let s=""!==e.srcElement.dataset.name?e.srcElement.dataset.name:"nothing!";""===e.srcElement.dataset.name&&e.srcElement.dataset.interaction&&(s="a tile with no name!");const i=e.srcElement.classList.contains("unset"),r=document.createElement("div");r.innerText=`Editing ${s}`,r.style.fontWeight="bold",r.style.marginBottom="5px",n.appendChild(r);let l=[];""===s||i?l=["New Tile","Copy Tile Here"].concat(l):(l=["Edit Tile"].concat(l),l.push("Remove Tile")),l=l.concat(["","New Page",`Folder: ${a.m.config.profile}`]);for(const t of l){const s=document.createElement("div");s.innerText=t,s.className="menuItem",s.onclick=()=>{switch(t){case"New Page":o.UI.Pages[Object.keys(o.UI.Pages).length]=[],a.m.page=Object.keys(o.UI.Pages).length-1,o.UI.reloadSounds(),a.m.sendEvent("page_change");break;case"---":break;case`Folder: ${a.m.config.profile}`:showPick("Switch to another Folder:",Object.keys(a.m.config.profiles).map((e=>({name:e}))),(({value:e})=>{a.m.page=0,a.m.save("page",a.m.page),a.m.send(a.m.events.companion.set_profile,e.name)}));break;case"Edit Tile":a.m.editTile(e);break;case"New Tile":{const t=Number.parseInt(e.srcElement.className.split(" ")[1].split("-")[1])+(a.m.page<0?1:0)+(a.m.page>0?a.m.config.iconCountPerPage*a.m.page:0),n="fdc."+1e7*Math.random();o.UI.reloadProfile();const s={type:"fd.none",pos:t,uuid:n,data:{}};a.m.send(a.m.events.companion.new_tile,{"New Tile":s}),a.m.listenForOnce("page_change",(()=>{a.m.editTile({srcElement:{getAttribute:e=>JSON.stringify(s),dataset:{name:"New Tile",interaction:JSON.stringify(s)},className:"button k-0 k"}})}));break}case"Remove Tile":if(o.UI.reloadProfile(),a.m.flags.isEnabled("no_ask_to_delete"))return void a.m.send(a.m.events.companion.del_tile,{name:e.srcElement.dataset.name,item:e.srcElement.getAttribute("data-interaction")});window.showPick(`Are you sure you want to remove ${a.m.cleanHTML(e.srcElement.dataset.name)}?`,[{name:"Yes",value:!0},{name:"No",value:!1}],(({value:t})=>{!0===t.value&&a.m.send(a.m.events.companion.del_tile,{name:e.srcElement.dataset.name,item:e.srcElement.getAttribute("data-interaction")})}),"This cannot be undone!");break;case"Copy Tile Here":n=e.srcElement,o.UI.reloadProfile(),showPick("Copy from:",a.m.app_sounds.map((e=>{const t=Object.keys(e)[0];return{name:t,type:e[t].type}})),(({value:e})=>{o.UI.reloadProfile();const t=a.m.app_sounds.filter((t=>Object.keys(t)[0]===e.name))[0][e.name],s=Number.parseInt(n.className.split(" ")[1].split("-")[1])+(a.m.page<0?1:0)+(a.m.page>0?a.m.config.iconCountPerPage*a.m.page:0);return a.m.send(a.m.events.companion.new_tile,{[e.name]:{type:t.type,plugin:t.plugin,pos:s,uuid:"fdc."+1e7*Math.random(),data:t.data}}),!0}))}var n},n.appendChild(s)}return document.body.appendChild(n),!1}},669:(e,t,n)=>{"use strict";function a(e){let t=e.length;for(;--t>=0;)e[t]=0}n.d(t,{m:()=>Xn});const o=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),r=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Array(576);a(l);const d=new Array(60);a(d);const c=new Array(512);a(c);const u=new Array(256);a(u);const m=new Array(29);a(m);const p=new Array(30);function h(e,t,n,a,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=a,this.max_length=o,this.has_stree=e&&e.length}let g,f,y;function v(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}a(p);const _=e=>e<256?c[e]:c[256+(e>>>7)],b=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},w=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,b(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},k=(e,t,n)=>{w(e,n[2*t],n[2*t+1])},S=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},x=(e,t,n)=>{const a=new Array(16);let o,s,i=0;for(o=1;o<=15;o++)i=i+n[o-1]<<1,a[o]=i;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=S(a[t]++,t))}},C=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},E=e=>{e.bi_valid>8?b(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},L=(e,t,n,a)=>{const o=2*t,s=2*n;return e[o]<e[s]||e[o]===e[s]&&a[t]<=a[n]},q=(e,t,n)=>{const a=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&L(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!L(t,a,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=a},T=(e,t,n)=>{let a,i,r,l,d=0;if(0!==e.sym_next)do{a=255&e.pending_buf[e.sym_buf+d++],a+=(255&e.pending_buf[e.sym_buf+d++])<<8,i=e.pending_buf[e.sym_buf+d++],0===a?k(e,i,t):(r=u[i],k(e,r+256+1,t),l=o[r],0!==l&&(i-=m[r],w(e,i,l)),a--,r=_(a),k(e,r,n),l=s[r],0!==l&&(a-=p[r],w(e,a,l)))}while(d<e.sym_next);k(e,256,t)},A=(e,t)=>{const n=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.elems;let i,r,l,d=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<s;i++)0!==n[2*i]?(e.heap[++e.heap_len]=d=i,e.depth[i]=0):n[2*i+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=d<2?++d:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,o&&(e.static_len-=a[2*l+1]);for(t.max_code=d,i=e.heap_len>>1;i>=1;i--)q(e,n,i);l=s;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],q(e,n,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,n[2*l]=n[2*i]+n[2*r],e.depth[l]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,n[2*i+1]=n[2*r+1]=l,e.heap[1]=l++,q(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,a=t.max_code,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,l=t.stat_desc.max_length;let d,c,u,m,p,h,g=0;for(m=0;m<=15;m++)e.bl_count[m]=0;for(n[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)c=e.heap[d],m=n[2*n[2*c+1]+1]+1,m>l&&(m=l,g++),n[2*c+1]=m,c>a||(e.bl_count[m]++,p=0,c>=r&&(p=i[c-r]),h=n[2*c],e.opt_len+=h*(m+p),s&&(e.static_len+=h*(o[2*c+1]+p)));if(0!==g){do{for(m=l-1;0===e.bl_count[m];)m--;e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(m=l;0!==m;m--)for(c=e.bl_count[m];0!==c;)u=e.heap[--d],u>a||(n[2*u+1]!==m&&(e.opt_len+=(m-n[2*u+1])*n[2*u],n[2*u+1]=m),c--)}})(e,t),x(n,d,e.bl_count)},I=(e,t,n)=>{let a,o,s=-1,i=t[1],r=0,l=7,d=4;for(0===i&&(l=138,d=3),t[2*(n+1)+1]=65535,a=0;a<=n;a++)o=i,i=t[2*(a+1)+1],++r<l&&o===i||(r<d?e.bl_tree[2*o]+=r:0!==o?(o!==s&&e.bl_tree[2*o]++,e.bl_tree[32]++):r<=10?e.bl_tree[34]++:e.bl_tree[36]++,r=0,s=o,0===i?(l=138,d=3):o===i?(l=6,d=3):(l=7,d=4))},N=(e,t,n)=>{let a,o,s=-1,i=t[1],r=0,l=7,d=4;for(0===i&&(l=138,d=3),a=0;a<=n;a++)if(o=i,i=t[2*(a+1)+1],!(++r<l&&o===i)){if(r<d)do{k(e,o,e.bl_tree)}while(0!=--r);else 0!==o?(o!==s&&(k(e,o,e.bl_tree),r--),k(e,16,e.bl_tree),w(e,r-3,2)):r<=10?(k(e,17,e.bl_tree),w(e,r-3,3)):(k(e,18,e.bl_tree),w(e,r-11,7));r=0,s=o,0===i?(l=138,d=3):o===i?(l=6,d=3):(l=7,d=4)}};let U=!1;const O=(e,t,n,a)=>{w(e,0+(a?1:0),3),E(e),b(e,n),b(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var $={_tr_init:e=>{U||((()=>{let e,t,n,a,r;const v=new Array(16);for(n=0,a=0;a<28;a++)for(m[a]=n,e=0;e<1<<o[a];e++)u[n++]=a;for(u[n-1]=a,r=0,a=0;a<16;a++)for(p[a]=r,e=0;e<1<<s[a];e++)c[r++]=a;for(r>>=7;a<30;a++)for(p[a]=r<<7,e=0;e<1<<s[a]-7;e++)c[256+r++]=a;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)l[2*e+1]=8,e++,v[8]++;for(;e<=255;)l[2*e+1]=9,e++,v[9]++;for(;e<=279;)l[2*e+1]=7,e++,v[7]++;for(;e<=287;)l[2*e+1]=8,e++,v[8]++;for(x(l,287,v),e=0;e<30;e++)d[2*e+1]=5,d[2*e]=S(e,5);g=new h(l,o,257,286,15),f=new h(d,s,0,30,15),y=new h(new Array(0),i,0,19,7)})(),U=!0),e.l_desc=new v(e.dyn_ltree,g),e.d_desc=new v(e.dyn_dtree,f),e.bl_desc=new v(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,C(e)},_tr_stored_block:O,_tr_flush_block:(e,t,n,a)=>{let o,s,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),A(e,e.l_desc),A(e,e.d_desc),i=(e=>{let t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),A(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*r[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=o&&(o=s)):o=s=n+5,n+4<=o&&-1!==t?O(e,t,n,a):4===e.strategy||s===o?(w(e,2+(a?1:0),3),T(e,l,d)):(w(e,4+(a?1:0),3),((e,t,n,a)=>{let o;for(w(e,t-257,5),w(e,n-1,5),w(e,a-4,4),o=0;o<a;o++)w(e,e.bl_tree[2*r[o]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),T(e,e.dyn_ltree,e.dyn_dtree)),C(e),a&&E(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(u[n]+256+1)]++,e.dyn_dtree[2*_(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{w(e,2,3),k(e,256,l),(e=>{16===e.bi_valid?(b(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},z=(e,t,n,a)=>{let o=65535&e,s=e>>>16&65535,i=0;for(;0!==n;){i=n>2e3?2e3:n,n-=i;do{o=o+t[a++]|0,s=s+o|0}while(--i);o%=65521,s%=65521}return o|s<<16};const D=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var P=(e,t,n,a)=>{const o=D,s=a+n;e^=-1;for(let n=a;n<s;n++)e=e>>>8^o[255&(e^t[n])];return~e},M={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},R={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:F,_tr_stored_block:H,_tr_flush_block:B,_tr_tally:j,_tr_align:Z}=$,{Z_NO_FLUSH:J,Z_PARTIAL_FLUSH:V,Z_FULL_FLUSH:G,Z_FINISH:W,Z_BLOCK:Y,Z_OK:K,Z_STREAM_END:X,Z_STREAM_ERROR:Q,Z_DATA_ERROR:ee,Z_BUF_ERROR:te,Z_DEFAULT_COMPRESSION:ne,Z_FILTERED:ae,Z_HUFFMAN_ONLY:oe,Z_RLE:se,Z_FIXED:ie,Z_DEFAULT_STRATEGY:re,Z_UNKNOWN:le,Z_DEFLATED:de}=R,ce=258,ue=262,me=42,pe=113,he=666,ge=(e,t)=>(e.msg=M[t],t),fe=e=>2*e-(e>4?9:0),ye=e=>{let t=e.length;for(;--t>=0;)e[t]=0},ve=e=>{let t,n,a,o=e.w_size;t=e.hash_size,a=t;do{n=e.head[--a],e.head[a]=n>=o?n-o:0}while(--t);t=o,a=t;do{n=e.prev[--a],e.prev[a]=n>=o?n-o:0}while(--t)};let _e=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const be=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},we=(e,t)=>{B(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,be(e.strm)},ke=(e,t)=>{e.pending_buf[e.pending++]=t},Se=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},xe=(e,t,n,a)=>{let o=e.avail_in;return o>a&&(o=a),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=z(e.adler,t,o,n):2===e.state.wrap&&(e.adler=P(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},Ce=(e,t)=>{let n,a,o=e.max_chain_length,s=e.strstart,i=e.prev_length,r=e.nice_match;const l=e.strstart>e.w_size-ue?e.strstart-(e.w_size-ue):0,d=e.window,c=e.w_mask,u=e.prev,m=e.strstart+ce;let p=d[s+i-1],h=d[s+i];e.prev_length>=e.good_match&&(o>>=2),r>e.lookahead&&(r=e.lookahead);do{if(n=t,d[n+i]===h&&d[n+i-1]===p&&d[n]===d[s]&&d[++n]===d[s+1]){s+=2,n++;do{}while(d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&d[++s]===d[++n]&&s<m);if(a=ce-(m-s),s=m-ce,a>i){if(e.match_start=t,i=a,a>=r)break;p=d[s+i-1],h=d[s+i]}}}while((t=u[t&c])>l&&0!=--o);return i<=e.lookahead?i:e.lookahead},Ee=e=>{const t=e.w_size;let n,a,o;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ue)&&(e.window.set(e.window.subarray(t,t+t-a),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),ve(e),a+=t),0===e.strm.avail_in)break;if(n=xe(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=_e(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=_e(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<ue&&0!==e.strm.avail_in)},Le=(e,t)=>{let n,a,o,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,r=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>o&&(n=o),n<s&&(0===n&&t!==W||t===J||n!==a+e.strm.avail_in))break;i=t===W&&n===a+e.strm.avail_in?1:0,H(e,0,0,i),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,be(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(xe(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===i);return r-=e.strm.avail_in,r&&(r>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=r&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-r,e.strm.next_in),e.strstart),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==J&&t!==W&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(xe(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,s=o>e.w_size?e.w_size:o,a=e.strstart-e.block_start,(a>=s||(a||t===W)&&t!==J&&0===e.strm.avail_in&&a<=o)&&(n=a>o?o:a,i=t===W&&0===e.strm.avail_in&&n===a?1:0,H(e,e.block_start,n,i),e.block_start+=n,be(e.strm)),i?3:1)},qe=(e,t)=>{let n,a;for(;;){if(e.lookahead<ue){if(Ee(e),e.lookahead<ue&&t===J)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=_e(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-ue&&(e.match_length=Ce(e,n)),e.match_length>=3)if(a=j(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=_e(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=_e(e,e.ins_h,e.window[e.strstart+1]);else a=j(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(we(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===W?(we(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(we(e,!1),0===e.strm.avail_out)?1:2},Te=(e,t)=>{let n,a,o;for(;;){if(e.lookahead<ue){if(Ee(e),e.lookahead<ue&&t===J)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=_e(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ue&&(e.match_length=Ce(e,n),e.match_length<=5&&(e.strategy===ae||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,a=j(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=_e(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(we(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(a=j(e,0,e.window[e.strstart-1]),a&&we(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=j(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===W?(we(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(we(e,!1),0===e.strm.avail_out)?1:2};function Ae(e,t,n,a,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=a,this.func=o}const Ie=[new Ae(0,0,0,0,Le),new Ae(4,4,8,4,qe),new Ae(4,5,16,8,qe),new Ae(4,6,32,32,qe),new Ae(4,4,16,16,Te),new Ae(8,16,32,32,Te),new Ae(8,16,128,128,Te),new Ae(8,32,128,256,Te),new Ae(32,128,258,1024,Te),new Ae(32,258,258,4096,Te)];function Ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=de,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ye(this.dyn_ltree),ye(this.dyn_dtree),ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ye(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ue=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==me&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==pe&&t.status!==he?1:0},Oe=e=>{if(Ue(e))return ge(e,Q);e.total_in=e.total_out=0,e.data_type=le;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?me:pe,e.adler=2===t.wrap?0:1,t.last_flush=-2,F(t),K},$e=e=>{const t=Oe(e);var n;return t===K&&((n=e.state).window_size=2*n.w_size,ye(n.head),n.max_lazy_match=Ie[n.level].max_lazy,n.good_match=Ie[n.level].good_length,n.nice_match=Ie[n.level].nice_length,n.max_chain_length=Ie[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},ze=(e,t,n,a,o,s)=>{if(!e)return Q;let i=1;if(t===ne&&(t=6),a<0?(i=0,a=-a):a>15&&(i=2,a-=16),o<1||o>9||n!==de||a<8||a>15||t<0||t>9||s<0||s>ie||8===a&&1!==i)return ge(e,Q);8===a&&(a=9);const r=new Ne;return e.state=r,r.strm=e,r.status=me,r.wrap=i,r.gzhead=null,r.w_bits=a,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=o+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new Uint8Array(2*r.w_size),r.head=new Uint16Array(r.hash_size),r.prev=new Uint16Array(r.w_size),r.lit_bufsize=1<<o+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Uint8Array(r.pending_buf_size),r.sym_buf=r.lit_bufsize,r.sym_end=3*(r.lit_bufsize-1),r.level=t,r.strategy=s,r.method=n,$e(e)};var De=ze,Pe=(e,t)=>Ue(e)||2!==e.state.wrap?Q:(e.state.gzhead=t,K),Me=(e,t)=>{if(Ue(e)||t>Y||t<0)return e?ge(e,Q):Q;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===he&&t!==W)return ge(e,0===e.avail_out?te:Q);const a=n.last_flush;if(n.last_flush=t,0!==n.pending){if(be(e),0===e.avail_out)return n.last_flush=-1,K}else if(0===e.avail_in&&fe(t)<=fe(a)&&t!==W)return ge(e,te);if(n.status===he&&0!==e.avail_in)return ge(e,te);if(n.status===me&&0===n.wrap&&(n.status=pe),n.status===me){let t=de+(n.w_bits-8<<4)<<8,a=-1;if(a=n.strategy>=oe||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=a<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Se(n,t),0!==n.strstart&&(Se(n,e.adler>>>16),Se(n,65535&e.adler)),e.adler=1,n.status=pe,be(e),0!==n.pending)return n.last_flush=-1,K}if(57===n.status)if(e.adler=0,ke(n,31),ke(n,139),ke(n,8),n.gzhead)ke(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ke(n,255&n.gzhead.time),ke(n,n.gzhead.time>>8&255),ke(n,n.gzhead.time>>16&255),ke(n,n.gzhead.time>>24&255),ke(n,9===n.level?2:n.strategy>=oe||n.level<2?4:0),ke(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ke(n,255&n.gzhead.extra.length),ke(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=P(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(ke(n,0),ke(n,0),ke(n,0),ke(n,0),ke(n,0),ke(n,9===n.level?2:n.strategy>=oe||n.level<2?4:0),ke(n,3),n.status=pe,be(e),0!==n.pending)return n.last_flush=-1,K;if(69===n.status){if(n.gzhead.extra){let t=n.pending,a=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+a>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=P(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=o,be(e),0!==n.pending)return n.last_flush=-1,K;t=0,a-=o}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending+=a,n.gzhead.hcrc&&n.pending>t&&(e.adler=P(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,a=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a&&(e.adler=P(e.adler,n.pending_buf,n.pending-a,a)),be(e),0!==n.pending)return n.last_flush=-1,K;a=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ke(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>a&&(e.adler=P(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,a=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a&&(e.adler=P(e.adler,n.pending_buf,n.pending-a,a)),be(e),0!==n.pending)return n.last_flush=-1,K;a=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ke(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>a&&(e.adler=P(e.adler,n.pending_buf,n.pending-a,a))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(be(e),0!==n.pending))return n.last_flush=-1,K;ke(n,255&e.adler),ke(n,e.adler>>8&255),e.adler=0}if(n.status=pe,be(e),0!==n.pending)return n.last_flush=-1,K}if(0!==e.avail_in||0!==n.lookahead||t!==J&&n.status!==he){let a=0===n.level?Le(n,t):n.strategy===oe?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Ee(e),0===e.lookahead)){if(t===J)return 1;break}if(e.match_length=0,n=j(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(we(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===W?(we(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(we(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===se?((e,t)=>{let n,a,o,s;const i=e.window;for(;;){if(e.lookahead<=ce){if(Ee(e),e.lookahead<=ce&&t===J)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,a=i[o],a===i[++o]&&a===i[++o]&&a===i[++o])){s=e.strstart+ce;do{}while(a===i[++o]&&a===i[++o]&&a===i[++o]&&a===i[++o]&&a===i[++o]&&a===i[++o]&&a===i[++o]&&a===i[++o]&&o<s);e.match_length=ce-(s-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=j(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=j(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(we(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===W?(we(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(we(e,!1),0===e.strm.avail_out)?1:2})(n,t):Ie[n.level].func(n,t);if(3!==a&&4!==a||(n.status=he),1===a||3===a)return 0===e.avail_out&&(n.last_flush=-1),K;if(2===a&&(t===V?Z(n):t!==Y&&(H(n,0,0,!1),t===G&&(ye(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),be(e),0===e.avail_out))return n.last_flush=-1,K}return t!==W?K:n.wrap<=0?X:(2===n.wrap?(ke(n,255&e.adler),ke(n,e.adler>>8&255),ke(n,e.adler>>16&255),ke(n,e.adler>>24&255),ke(n,255&e.total_in),ke(n,e.total_in>>8&255),ke(n,e.total_in>>16&255),ke(n,e.total_in>>24&255)):(Se(n,e.adler>>>16),Se(n,65535&e.adler)),be(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?K:X)},Re=e=>{if(Ue(e))return Q;const t=e.state.status;return e.state=null,t===pe?ge(e,ee):K},Fe=(e,t)=>{let n=t.length;if(Ue(e))return Q;const a=e.state,o=a.wrap;if(2===o||1===o&&a.status!==me||a.lookahead)return Q;if(1===o&&(e.adler=z(e.adler,t,n,0)),a.wrap=0,n>=a.w_size){0===o&&(ye(a.head),a.strstart=0,a.block_start=0,a.insert=0);let e=new Uint8Array(a.w_size);e.set(t.subarray(n-a.w_size,n),0),t=e,n=a.w_size}const s=e.avail_in,i=e.next_in,r=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Ee(a);a.lookahead>=3;){let e=a.strstart,t=a.lookahead-2;do{a.ins_h=_e(a,a.ins_h,a.window[e+3-1]),a.prev[e&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=e,e++}while(--t);a.strstart=e,a.lookahead=2,Ee(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,e.next_in=i,e.input=r,e.avail_in=s,a.wrap=o,K};const He=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Be=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)He(n,t)&&(e[t]=n[t])}}return e},je=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,a=0,o=e.length;t<o;t++){let o=e[t];n.set(o,a),a+=o.length}return n};let Ze=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ze=!1}const Je=new Uint8Array(256);for(let e=0;e<256;e++)Je[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Je[254]=Je[254]=1;var Ve=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,a,o,s,i=e.length,r=0;for(o=0;o<i;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<i&&(a=e.charCodeAt(o+1),56320==(64512&a)&&(n=65536+(n-55296<<10)+(a-56320),o++)),r+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(r),s=0,o=0;s<r;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<i&&(a=e.charCodeAt(o+1),56320==(64512&a)&&(n=65536+(n-55296<<10)+(a-56320),o++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},Ge=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let a,o;const s=new Array(2*n);for(o=0,a=0;a<n;){let t=e[a++];if(t<128){s[o++]=t;continue}let i=Je[t];if(i>4)s[o++]=65533,a+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&a<n;)t=t<<6|63&e[a++],i--;i>1?s[o++]=65533:t<65536?s[o++]=t:(t-=65536,s[o++]=55296|t>>10&1023,s[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Ze)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n})(s,o)},We=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Je[e[n]]>t?n:t},Ye=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ke=Object.prototype.toString,{Z_NO_FLUSH:Xe,Z_SYNC_FLUSH:Qe,Z_FULL_FLUSH:et,Z_FINISH:tt,Z_OK:nt,Z_STREAM_END:at,Z_DEFAULT_COMPRESSION:ot,Z_DEFAULT_STRATEGY:st,Z_DEFLATED:it}=R;function rt(e){this.options=Be({level:ot,method:it,chunkSize:16384,windowBits:15,memLevel:8,strategy:st},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ye,this.strm.avail_out=0;let n=De(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==nt)throw new Error(M[n]);if(t.header&&Pe(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Ve(t.dictionary):"[object ArrayBuffer]"===Ke.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Fe(this.strm,e),n!==nt)throw new Error(M[n]);this._dict_set=!0}}function lt(e,t){const n=new rt(t);if(n.push(e,!0),n.err)throw n.msg||M[n.err];return n.result}rt.prototype.push=function(e,t){const n=this.strm,a=this.options.chunkSize;let o,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?tt:Xe,"string"==typeof e?n.input=Ve(e):"[object ArrayBuffer]"===Ke.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(a),n.next_out=0,n.avail_out=a),(s===Qe||s===et)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=Me(n,s),o===at)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=Re(this.strm),this.onEnd(o),this.ended=!0,o===nt;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},rt.prototype.onData=function(e){this.chunks.push(e)},rt.prototype.onEnd=function(e){e===nt&&(this.result=je(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var dt={Deflate:rt,deflate:lt,deflateRaw:function(e,t){return(t=t||{}).raw=!0,lt(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,lt(e,t)},constants:R};const ct=16209;var ut=function(e,t){let n,a,o,s,i,r,l,d,c,u,m,p,h,g,f,y,v,_,b,w,k,S,x,C;const E=e.state;n=e.next_in,x=e.input,a=n+(e.avail_in-5),o=e.next_out,C=e.output,s=o-(t-e.avail_out),i=o+(e.avail_out-257),r=E.dmax,l=E.wsize,d=E.whave,c=E.wnext,u=E.window,m=E.hold,p=E.bits,h=E.lencode,g=E.distcode,f=(1<<E.lenbits)-1,y=(1<<E.distbits)-1;e:do{p<15&&(m+=x[n++]<<p,p+=8,m+=x[n++]<<p,p+=8),v=h[m&f];t:for(;;){if(_=v>>>24,m>>>=_,p-=_,_=v>>>16&255,0===_)C[o++]=65535&v;else{if(!(16&_)){if(64&_){if(32&_){E.mode=16191;break e}e.msg="invalid literal/length code",E.mode=ct;break e}v=h[(65535&v)+(m&(1<<_)-1)];continue t}for(b=65535&v,_&=15,_&&(p<_&&(m+=x[n++]<<p,p+=8),b+=m&(1<<_)-1,m>>>=_,p-=_),p<15&&(m+=x[n++]<<p,p+=8,m+=x[n++]<<p,p+=8),v=g[m&y];;){if(_=v>>>24,m>>>=_,p-=_,_=v>>>16&255,16&_){if(w=65535&v,_&=15,p<_&&(m+=x[n++]<<p,p+=8,p<_&&(m+=x[n++]<<p,p+=8)),w+=m&(1<<_)-1,w>r){e.msg="invalid distance too far back",E.mode=ct;break e}if(m>>>=_,p-=_,_=o-s,w>_){if(_=w-_,_>d&&E.sane){e.msg="invalid distance too far back",E.mode=ct;break e}if(k=0,S=u,0===c){if(k+=l-_,_<b){b-=_;do{C[o++]=u[k++]}while(--_);k=o-w,S=C}}else if(c<_){if(k+=l+c-_,_-=c,_<b){b-=_;do{C[o++]=u[k++]}while(--_);if(k=0,c<b){_=c,b-=_;do{C[o++]=u[k++]}while(--_);k=o-w,S=C}}}else if(k+=c-_,_<b){b-=_;do{C[o++]=u[k++]}while(--_);k=o-w,S=C}for(;b>2;)C[o++]=S[k++],C[o++]=S[k++],C[o++]=S[k++],b-=3;b&&(C[o++]=S[k++],b>1&&(C[o++]=S[k++]))}else{k=o-w;do{C[o++]=C[k++],C[o++]=C[k++],C[o++]=C[k++],b-=3}while(b>2);b&&(C[o++]=C[k++],b>1&&(C[o++]=C[k++]))}break}if(64&_){e.msg="invalid distance code",E.mode=ct;break e}v=g[(65535&v)+(m&(1<<_)-1)]}}break}}while(n<a&&o<i);b=p>>3,n-=b,p-=b<<3,m&=(1<<p)-1,e.next_in=n,e.next_out=o,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=o<i?i-o+257:257-(o-i),E.hold=m,E.bits=p};const mt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),pt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ht=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),gt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ft=(e,t,n,a,o,s,i,r)=>{const l=r.bits;let d,c,u,m,p,h,g=0,f=0,y=0,v=0,_=0,b=0,w=0,k=0,S=0,x=0,C=null;const E=new Uint16Array(16),L=new Uint16Array(16);let q,T,A,I=null;for(g=0;g<=15;g++)E[g]=0;for(f=0;f<a;f++)E[t[n+f]]++;for(_=l,v=15;v>=1&&0===E[v];v--);if(_>v&&(_=v),0===v)return o[s++]=20971520,o[s++]=20971520,r.bits=1,0;for(y=1;y<v&&0===E[y];y++);for(_<y&&(_=y),k=1,g=1;g<=15;g++)if(k<<=1,k-=E[g],k<0)return-1;if(k>0&&(0===e||1!==v))return-1;for(L[1]=0,g=1;g<15;g++)L[g+1]=L[g]+E[g];for(f=0;f<a;f++)0!==t[n+f]&&(i[L[t[n+f]]++]=f);if(0===e?(C=I=i,h=20):1===e?(C=mt,I=pt,h=257):(C=ht,I=gt,h=0),x=0,f=0,g=y,p=s,b=_,w=0,u=-1,S=1<<_,m=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){q=g-w,i[f]+1<h?(T=0,A=i[f]):i[f]>=h?(T=I[i[f]-h],A=C[i[f]-h]):(T=96,A=0),d=1<<g-w,c=1<<b,y=c;do{c-=d,o[p+(x>>w)+c]=q<<24|T<<16|A}while(0!==c);for(d=1<<g-1;x&d;)d>>=1;if(0!==d?(x&=d-1,x+=d):x=0,f++,0==--E[g]){if(g===v)break;g=t[n+i[f]]}if(g>_&&(x&m)!==u){for(0===w&&(w=_),p+=y,b=g-w,k=1<<b;b+w<v&&(k-=E[b+w],!(k<=0));)b++,k<<=1;if(S+=1<<b,1===e&&S>852||2===e&&S>592)return 1;u=x&m,o[u]=_<<24|b<<16|p-s}}return 0!==x&&(o[p+x]=g-w<<24|64<<16),r.bits=_,0};const{Z_FINISH:yt,Z_BLOCK:vt,Z_TREES:_t,Z_OK:bt,Z_STREAM_END:wt,Z_NEED_DICT:kt,Z_STREAM_ERROR:St,Z_DATA_ERROR:xt,Z_MEM_ERROR:Ct,Z_BUF_ERROR:Et,Z_DEFLATED:Lt}=R,qt=16180,Tt=16190,At=16191,It=16192,Nt=16194,Ut=16199,Ot=16200,$t=16206,zt=16209,Dt=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Pt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Mt=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<qt||t.mode>16211?1:0},Rt=e=>{if(Mt(e))return St;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=qt,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,bt},Ft=e=>{if(Mt(e))return St;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Rt(e)},Ht=(e,t)=>{let n;if(Mt(e))return St;const a=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?St:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=n,a.wbits=t,Ft(e))},Bt=(e,t)=>{if(!e)return St;const n=new Pt;e.state=n,n.strm=e,n.window=null,n.mode=qt;const a=Ht(e,t);return a!==bt&&(e.state=null),a};let jt,Zt,Jt=!0;const Vt=e=>{if(Jt){jt=new Int32Array(512),Zt=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ft(1,e.lens,0,288,jt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ft(2,e.lens,0,32,Zt,0,e.work,{bits:5}),Jt=!1}e.lencode=jt,e.lenbits=9,e.distcode=Zt,e.distbits=5},Gt=(e,t,n,a)=>{let o;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(o=s.wsize-s.wnext,o>a&&(o=a),s.window.set(t.subarray(n-a,n-a+o),s.wnext),(a-=o)?(s.window.set(t.subarray(n-a,n),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0};var Wt=Ft,Yt=Bt,Kt=(e,t)=>{let n,a,o,s,i,r,l,d,c,u,m,p,h,g,f,y,v,_,b,w,k,S,x=0;const C=new Uint8Array(4);let E,L;const q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mt(e)||!e.output||!e.input&&0!==e.avail_in)return St;n=e.state,n.mode===At&&(n.mode=It),i=e.next_out,o=e.output,l=e.avail_out,s=e.next_in,a=e.input,r=e.avail_in,d=n.hold,c=n.bits,u=r,m=l,S=bt;e:for(;;)switch(n.mode){case qt:if(0===n.wrap){n.mode=It;break}for(;c<16;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(2&n.wrap&&35615===d){0===n.wbits&&(n.wbits=15),n.check=0,C[0]=255&d,C[1]=d>>>8&255,n.check=P(n.check,C,2,0),d=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=zt;break}if((15&d)!==Lt){e.msg="unknown compression method",n.mode=zt;break}if(d>>>=4,c-=4,k=8+(15&d),0===n.wbits&&(n.wbits=k),k>15||k>n.wbits){e.msg="invalid window size",n.mode=zt;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&d?16189:At,d=0,c=0;break;case 16181:for(;c<16;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(n.flags=d,(255&n.flags)!==Lt){e.msg="unknown compression method",n.mode=zt;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=zt;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=P(n.check,C,2,0)),d=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.head&&(n.head.time=d),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,C[2]=d>>>16&255,C[3]=d>>>24&255,n.check=P(n.check,C,4,0)),d=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=P(n.check,C,2,0)),d=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&4&n.wrap&&(C[0]=255&d,C[1]=d>>>8&255,n.check=P(n.check,C,2,0)),d=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(p=n.length,p>r&&(p=r),p&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(a.subarray(s,s+p),k)),512&n.flags&&4&n.wrap&&(n.check=P(n.check,a,p,s)),r-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===r)break e;p=0;do{k=a[s+p++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&p<r);if(512&n.flags&&4&n.wrap&&(n.check=P(n.check,a,p,s)),r-=p,s+=p,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===r)break e;p=0;do{k=a[s+p++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&p<r);if(512&n.flags&&4&n.wrap&&(n.check=P(n.check,a,p,s)),r-=p,s+=p,k)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(4&n.wrap&&d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=zt;break}d=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=At;break;case 16189:for(;c<32;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}e.adler=n.check=Dt(d),d=0,c=0,n.mode=Tt;case Tt:if(0===n.havedict)return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=r,n.hold=d,n.bits=c,kt;e.adler=n.check=1,n.mode=At;case At:if(t===vt||t===_t)break e;case It:if(n.last){d>>>=7&c,c-=7&c,n.mode=$t;break}for(;c<3;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}switch(n.last=1&d,d>>>=1,c-=1,3&d){case 0:n.mode=16193;break;case 1:if(Vt(n),n.mode=Ut,t===_t){d>>>=2,c-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=zt}d>>>=2,c-=2;break;case 16193:for(d>>>=7&c,c-=7&c;c<32;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=zt;break}if(n.length=65535&d,d=0,c=0,n.mode=Nt,t===_t)break e;case Nt:n.mode=16195;case 16195:if(p=n.length,p){if(p>r&&(p=r),p>l&&(p=l),0===p)break e;o.set(a.subarray(s,s+p),i),r-=p,s+=p,l-=p,i+=p,n.length-=p;break}n.mode=At;break;case 16196:for(;c<14;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(n.nlen=257+(31&d),d>>>=5,c-=5,n.ndist=1+(31&d),d>>>=5,c-=5,n.ncode=4+(15&d),d>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=zt;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.lens[q[n.have++]]=7&d,d>>>=3,c-=3}for(;n.have<19;)n.lens[q[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},S=ft(0,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,S){e.msg="invalid code lengths set",n.mode=zt;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;x=n.lencode[d&(1<<n.lenbits)-1],f=x>>>24,y=x>>>16&255,v=65535&x,!(f<=c);){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(v<16)d>>>=f,c-=f,n.lens[n.have++]=v;else{if(16===v){for(L=f+2;c<L;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(d>>>=f,c-=f,0===n.have){e.msg="invalid bit length repeat",n.mode=zt;break}k=n.lens[n.have-1],p=3+(3&d),d>>>=2,c-=2}else if(17===v){for(L=f+3;c<L;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}d>>>=f,c-=f,k=0,p=3+(7&d),d>>>=3,c-=3}else{for(L=f+7;c<L;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}d>>>=f,c-=f,k=0,p=11+(127&d),d>>>=7,c-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=zt;break}for(;p--;)n.lens[n.have++]=k}}if(n.mode===zt)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=zt;break}if(n.lenbits=9,E={bits:n.lenbits},S=ft(1,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,S){e.msg="invalid literal/lengths set",n.mode=zt;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},S=ft(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,S){e.msg="invalid distances set",n.mode=zt;break}if(n.mode=Ut,t===_t)break e;case Ut:n.mode=Ot;case Ot:if(r>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=r,n.hold=d,n.bits=c,ut(e,m),i=e.next_out,o=e.output,l=e.avail_out,s=e.next_in,a=e.input,r=e.avail_in,d=n.hold,c=n.bits,n.mode===At&&(n.back=-1);break}for(n.back=0;x=n.lencode[d&(1<<n.lenbits)-1],f=x>>>24,y=x>>>16&255,v=65535&x,!(f<=c);){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(y&&!(240&y)){for(_=f,b=y,w=v;x=n.lencode[w+((d&(1<<_+b)-1)>>_)],f=x>>>24,y=x>>>16&255,v=65535&x,!(_+f<=c);){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}d>>>=_,c-=_,n.back+=_}if(d>>>=f,c-=f,n.back+=f,n.length=v,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=At;break}if(64&y){e.msg="invalid literal/length code",n.mode=zt;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(L=n.extra;c<L;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;x=n.distcode[d&(1<<n.distbits)-1],f=x>>>24,y=x>>>16&255,v=65535&x,!(f<=c);){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(!(240&y)){for(_=f,b=y,w=v;x=n.distcode[w+((d&(1<<_+b)-1)>>_)],f=x>>>24,y=x>>>16&255,v=65535&x,!(_+f<=c);){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}d>>>=_,c-=_,n.back+=_}if(d>>>=f,c-=f,n.back+=f,64&y){e.msg="invalid distance code",n.mode=zt;break}n.offset=v,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(L=n.extra;c<L;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=zt;break}n.mode=16204;case 16204:if(0===l)break e;if(p=m-l,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=zt;break}p>n.wnext?(p-=n.wnext,h=n.wsize-p):h=n.wnext-p,p>n.length&&(p=n.length),g=n.window}else g=o,h=i-n.offset,p=n.length;p>l&&(p=l),l-=p,n.length-=p;do{o[i++]=g[h++]}while(--p);0===n.length&&(n.mode=Ot);break;case 16205:if(0===l)break e;o[i++]=n.length,l--,n.mode=Ot;break;case $t:if(n.wrap){for(;c<32;){if(0===r)break e;r--,d|=a[s++]<<c,c+=8}if(m-=l,e.total_out+=m,n.total+=m,4&n.wrap&&m&&(e.adler=n.check=n.flags?P(n.check,o,m,i-m):z(n.check,o,m,i-m)),m=l,4&n.wrap&&(n.flags?d:Dt(d))!==n.check){e.msg="incorrect data check",n.mode=zt;break}d=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===r)break e;r--,d+=a[s++]<<c,c+=8}if(4&n.wrap&&d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=zt;break}d=0,c=0}n.mode=16208;case 16208:S=wt;break e;case zt:S=xt;break e;case 16210:return Ct;default:return St}return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=r,n.hold=d,n.bits=c,(n.wsize||m!==e.avail_out&&n.mode<zt&&(n.mode<$t||t!==yt))&&Gt(e,e.output,e.next_out,m-e.avail_out),u-=e.avail_in,m-=e.avail_out,e.total_in+=u,e.total_out+=m,n.total+=m,4&n.wrap&&m&&(e.adler=n.check=n.flags?P(n.check,o,m,e.next_out-m):z(n.check,o,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===At?128:0)+(n.mode===Ut||n.mode===Nt?256:0),(0===u&&0===m||t===yt)&&S===bt&&(S=Et),S},Xt=e=>{if(Mt(e))return St;let t=e.state;return t.window&&(t.window=null),e.state=null,bt},Qt=(e,t)=>{if(Mt(e))return St;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,bt):St},en=(e,t)=>{const n=t.length;let a,o,s;return Mt(e)?St:(a=e.state,0!==a.wrap&&a.mode!==Tt?St:a.mode===Tt&&(o=1,o=z(o,t,n,0),o!==a.check)?xt:(s=Gt(e,t,n,n),s?(a.mode=16210,Ct):(a.havedict=1,bt)))},tn=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const nn=Object.prototype.toString,{Z_NO_FLUSH:an,Z_FINISH:on,Z_OK:sn,Z_STREAM_END:rn,Z_NEED_DICT:ln,Z_STREAM_ERROR:dn,Z_DATA_ERROR:cn,Z_MEM_ERROR:un}=R;function mn(e){this.options=Be({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ye,this.strm.avail_out=0;let n=Yt(this.strm,t.windowBits);if(n!==sn)throw new Error(M[n]);if(this.header=new tn,Qt(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ve(t.dictionary):"[object ArrayBuffer]"===nn.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=en(this.strm,t.dictionary),n!==sn)))throw new Error(M[n])}function pn(e,t){const n=new mn(t);if(n.push(e),n.err)throw n.msg||M[n.err];return n.result}mn.prototype.push=function(e,t){const n=this.strm,a=this.options.chunkSize,o=this.options.dictionary;let s,i,r;if(this.ended)return!1;for(i=t===~~t?t:!0===t?on:an,"[object ArrayBuffer]"===nn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(a),n.next_out=0,n.avail_out=a),s=Kt(n,i),s===ln&&o&&(s=en(n,o),s===sn?s=Kt(n,i):s===cn&&(s=ln));n.avail_in>0&&s===rn&&n.state.wrap>0&&0!==e[n.next_in];)Wt(n),s=Kt(n,i);switch(s){case dn:case cn:case ln:case un:return this.onEnd(s),this.ended=!0,!1}if(r=n.avail_out,n.next_out&&(0===n.avail_out||s===rn))if("string"===this.options.to){let e=We(n.output,n.next_out),t=n.next_out-e,o=Ge(n.output,e);n.next_out=t,n.avail_out=a-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==sn||0!==r){if(s===rn)return s=Xt(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},mn.prototype.onData=function(e){this.chunks.push(e)},mn.prototype.onEnd=function(e){e===sn&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=je(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var hn={Inflate:mn,inflate:pn,inflateRaw:function(e,t){return(t=t||{}).raw=!0,pn(e,t)},ungzip:pn,constants:R};const{Deflate:gn,deflate:fn,deflateRaw:yn,gzip:vn}=dt,{Inflate:_n,inflate:bn,inflateRaw:wn,ungzip:kn}=hn;var Sn={Deflate:gn,deflate:fn,deflateRaw:yn,gzip:vn,Inflate:_n,inflate:bn,inflateRaw:wn,ungzip:kn,constants:R};const xn=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Cn=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const t=e.match(xn);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},En=e=>"*"===e||"x"===e||"X"===e,Ln=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},qn=(e,t)=>{if(En(e)||En(t))return 0;const[n,a]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(Ln(e),Ln(t));return n>a?1:n<a?-1:0},Tn=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const a=qn(e[n]||"0",t[n]||"0");if(0!==a)return a}return 0},An={official:[{type:"v3",title:"freedeck.app",url:"https://releases.freedeck.app/index.json",channel:"main"}],unofficial:[],getLegacyRepository:async function(e){return new Promise(((t,n)=>{const a=[];fetch(e).catch((e=>{n(e)})).then((e=>e.text())).then((e=>{e.includes(",!")||n({err:!0,msg:"No plugin metadata found."});let o=e.split("\n");o.shift(),o=o.filter((e=>e.length>0));for(const e of o){const t=e.split(",!"),n={file:t[0],githubRepo:`https://github.com/${t[1]}`,name:t[2],author:t[3],version:t[4],description:t[5],id:t[6]};a.push(n)}t(a)}))}))},getV3Repository:async function(e){const t=[],n=await fetch(`${e.url}?time=${Date.now()}`).catch((e=>e)),a=await n.json();if(!a.channels[e.channel])return{err:!0,msg:`Channel ${e.channel} not found.`};const o=a.channels[e.channel];let s=o.catalog;if("repository_external"===o.type){const e=await fetch(o.catalog).catch((e=>e));s=await e.json()}for(const e in s){const n=s[e];n.id=e,t.push(n)}return{...o,plugins:t}}},In=An;var Nn=n(340);const Un=e=>{const t={};for(const n of e)t[n.name]=[n.friendly,n.volume];for(const e of document.querySelectorAll(".button")){if(!e.getAttribute("data-interaction"))continue;if("editor-btn"===e.id)continue;let n=e.getAttribute("data-interaction");n=JSON.parse(n),"slider"===n.renderType&&n.data.app&&t[n.data.app]&&(n.data.value=100*t[n.data.app][1],e.setAttribute("data-interaction",JSON.stringify(n)),e.querySelector(".slider-container").dataset.value=100*t[n.data.app][1])}};function On(){universal.nbws&&universal.nbws.send("get_apps","")}const $n={cache:[],send:(e,...t)=>{universal.send(universal.events.nbws.sendRequest,[e,t])},on:(e,t)=>{universal.on(`NBWS_${e}`,(e=>{t(e)}))},once:(e,t)=>{universal.once(`NBWS_${e}`,(e=>{t(e)}))},setVolume:(e,t)=>{$n.send("set_volume",e,`${t}`),$n.once("volume_set",(e=>{$n.cache=e,Un($n.cache)}))}};function zn(){universal.nbws=$n,universal.nbws.on("error",(e=>{universal.sendToast("Native WebSocket",e)})),universal.nbws.on("apps",(e=>{universal.nbws.cache=e,Un(e)})),0!==Object.values(universal.nbws.cache).length&&Un(universal.nbws.cache),On(),On(),universal.listenFor("page_change",(()=>{0!==Object.values(universal.nbws.cache).length&&Un(universal.nbws.cache),On()})),setInterval((()=>{0!==Object.values(universal.nbws.cache).length&&Un(universal.nbws.cache),On()}),250)}function Dn(){universal.on(universal.events.companion.native_keypress,(e=>{var t,n;t=e.data.app,n=e.data.value,universal.nbws.setVolume(t,n)})),universal.on(universal.events.keypress,(e=>{if("fd.profile"===e.type&&(universal.page=0,universal.save("page",universal.page),universal.send(universal.events.companion.set_profile,e.data.profile)),"fd.macro_text"===e.type&&universal.nbws.send("macro_text",e.data.macro),"fd.macro"===e.type&&universal.nbws.send("macro",e.data.macro),"fd.fullscreen"===e.type){const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}}))}var Pn=n(44);const Mn={_nowPlaying:[],_end:e=>{universal.audioClient._nowPlaying.splice(universal.audioClient._nowPlaying.indexOf(e.target),1),universal.updatePlaying()},_player:{normalVol:1,monitorVol:1,pitch:1},sinkManager:{types:{monitor:0,vbcable:1},sinks:[],devices:[],reloadDevices:async()=>{if(navigator.mediaDevices?.enumerateDevices){const e=[];navigator.mediaDevices.enumerateDevices().then((e=>e.filter((e=>"audiooutput"===e.kind)))).catch((e=>{console.error(e)}));for(const t of e)Mn.sinkManager.devices.push(t),universal.CLU("Boot / Universal:AudioEngine","Created monitor potential devices")}else console.log("enumerateDevices() not supported.")},initialize:()=>{Mn.sinkManager.reloadDevices(),universal.exists("audio/sinks")?(Mn.sinkManager.sinks=universal.loadObj("audio/sinks"),universal.CLU("Boot / Universal:AudioEngine","Loaded audio/sinks")):(universal.CLU("Boot / Universal:AudioEngine","No audio/sinks found, creating new"),universal.saveObj("audio/sinks",Mn.sinkManager.sinks))},addAndRemoveSink:async(e,t,n)=>{Mn.sinkManager.sinks=Mn.sinkManager.sinks.filter((e=>e.id!==n)),universal.CLU("Boot / Universal:AudioEngine","Removed sink"),Mn.sinkManager.addSink(e,t)},removeSink:async e=>{Mn.sinkManager.sinks=Mn.sinkManager.sinks.filter((t=>t.id!==e)),universal.CLU("Boot / Universal:AudioEngine","Removed sink"),universal.saveObj("audio/sinks",Mn.sinkManager.sinks)},addSink:async(e,t)=>{Mn.sinkManager.sinks.push({type:e,id:t}),universal.CLU("Boot / Universal:AudioEngine","Added sink"),universal.saveObj("audio/sinks",Mn.sinkManager.sinks)},getSinksForType:e=>Mn.sinkManager.sinks.filter((t=>t.type===e)),hasSink:e=>Mn.sinkManager.sinks.some((t=>t.id===e))},stopAll:async()=>{for(const e of universal.audioClient._nowPlaying)try{await e.pause()}catch(e){}},setPitch:e=>{universal.audioClient._player.pitch=e;for(const t of universal.audioClient._nowPlaying)t.playbackRate=e;universal.save("pitch",e)},setVolume:(e,t=Mn.channels.cable)=>{t===Mn.channels.monitor?universal.audioClient._player.monitorVol=e:universal.audioClient._player.normalVol=e;for(const n of universal.audioClient._nowPlaying)n.dataset.channel===t.toString()&&(n.volume=e);universal.save(`vol-${t}`,e)},channels:{cable:0,monitor:1,ui:2},sinks:[],initialize:()=>{universal.CLU("Boot / Universal:AudioEngine","Initializing audio engine"),Mn.sinkManager.initialize(),universal.exists("vb.sink")&&(universal.audioClient.sinkManager.addSink(universal.audioClient.sinkManager.types.vbcable,universal.load("vb.sink")),universal.remove("vb.sink")),universal.exists("monitor.sink")&&(universal.audioClient.sinkManager.addSink(universal.audioClient.sinkManager.types.monitor,universal.load("monitor.sink")),universal.remove("monitor.sink"))},play:async({file:e,name:t,stopPrevious:n="stop_prev"===universal.load("playback-mode"),volume:a=universal.load("vol-0F")||1,pitch:o=universal.load("pitch")||1,channel:s})=>{const i=[];let r=1;const l=universal.audioClient.channels;if(s===l.monitor||s===l.ui){for(const e of Mn.sinkManager.getSinksForType(Mn.sinkManager.types.monitor))i.push(e.id);r=universal.audioClient._player.monitorVol,s===l.ui&&(r=a)}else{for(const e of Mn.sinkManager.getSinksForType(Mn.sinkManager.types.vbcable))i.push(e.id);r=universal.audioClient._player.normalVol}for(const a of i)await Mn._play({file:e,name:t,stopPrevious:n,volume:r,pitch:o,channel:s,sink:a})},_play:async({file:e,name:t,stopPrevious:n="stop_prev"===universal.load("playback-mode"),volume:a=universal.load("vol-0")||1,pitch:o=universal.load("pitch")||1,channel:s,sink:i})=>{const r=universal.audioClient.channels,l=new Audio;if(l.src=e,l.load(),await l.setSinkId(i),l.playbackRate=o,l.volume=a,l.preservesPitch=!1,l.dataset.name=t,l.dataset.channel=s,l.dataset.monitoring=s===r.monitor,!0===n&&s!==r.ui)for(const e of universal.audioClient._nowPlaying)try{e.dataset.name===t&&e.dataset.channel===s.toString()&&await e.pause()}catch(e){}return l.play(),l.onpause=e=>{universal.sendEvent("audio-end",{audioInstance:l,name:t,channel:s}),universal.audioClient._end(e),l.remove()},universal.audioClient._nowPlaying.push(l),universal.sendEvent("now-playing",{audioInstance:l,name:t,channel:s}),universal.updatePlaying(),l},useSinkIfExists:async(e,t,n)=>{navigator.mediaDevices.getUserMedia({audio:!0,video:!1}),universal.load(t)?await e.setSinkId(universal.load(t)):await e.setSinkId(n)}},Rn=Mn,Fn=[],Hn={};let Bn=()=>{};function jn(e){return e.endsWith("#")?`/user-data/themes/${e.split("#")[0]}`:`/app/shared/theming/${e}`}async function Zn(e,t){const n={},a=t.split("\n");for(const e of a){if(!e.trim())continue;const[t,a]=e.trim().split(": ");n[t.split("--")[1]]=a.split('";')[0].split('"')[1]}return n.raw=t,Hn[e]=n,n}const Jn={listing:Fn,listingData:Hn,initialize:async function(){for(const e of universal._information.themes)Fn.push(e),universal.CLU("Boot / Theme Engine",`Added theme ${e}`)},fetchAndParse:async function(e){const t=await fetch(jn(e));if(200!==t.status)return console.error(`Failed to fetch theme ${e}`),universal.sendToast(`Failed to fetch theme ${e}`);const n=(await t.text()).match(/:theme-meta {([\s\S]*?)}/);return n?await Zn(e,n[1]):(universal.sendToast(`Failed to parse theme ${e}`),console.error(`Failed to parse theme ${e}`))},setTheme:function(e,t=!0){const n=Fn.includes(e)?e:"default";fetch(jn(n)).then((e=>e.text())).then((n=>{document.getElementById("theme")&&document.getElementById("theme").remove();const a=document.createElement("style");a.id="theme",a.innerText+=n,document.body.appendChild(a);const o=n.match(/:theme-meta {([\s\S]*?)}/),s=Zn(e,o[1]);Bn=()=>s,t&&universal.send(universal.events.companion.set_theme,e),universal.save("theme",e)})).catch((()=>{console.error("Failed to load theme."),universal.sendToast("Failed to load theme.")}))},currentTheme:Bn};function Vn(){Wn.enabled()&&(Wn.currentSoundpack=universal.load("soundpack")||"futuristic.soundpack",universal.CLU("Boot / UI Sounds","Auto-detecting current soundpack"),Wn.load(Wn.currentSoundpack).then((()=>{universal.CLU("Boot / UI Sounds","Loaded current soundpack."),Gn("page_enter")})))}async function Gn(e){Wn.enabled()&&universal.audioClient.play({file:`/common/sounds/${Wn.info.id}/${Wn.sounds[e]}`,name:e,channel:universal.audioClient.channels.ui,stopPrevious:!1,volume:.5})}const Wn={enabled:()=>universal.flags.isEnabled("uiSounds"),currentSoundpack:"futuristic.soundpack",info:{},sounds:{},playing:[],initialize:function(){universal.CLU("Boot / UI Sounds","Set enabled"),Wn.reload(),universal.CLU("Boot / UI Sounds","Reloaded sounds")},reload:Vn,load:async function(e){universal.CLU("Boot / UI Sounds",`Loading soundpack ${e}`);const t=await fetch(`/common/sounds/${e}/manifest.fdsp.json`).catch((e=>{console.error(e),universal.sendToast("Failed to load soundpack. Defaulting to futuristic."),Wn.currentSoundpack="futuristic.soundpack",Vn()}));universal.CLU("Boot / UI Sounds","Fetched manifest");const n=await t.json();return Wn.sounds=n.sounds,Wn.info=n.info,!0},playSound:Gn},Yn=Wn;var Kn=n(656);window.AppSM=function(){"Main"===Xn.name&&(document.querySelector(".settings-menu").style.display="flex",document.querySelector("#keys").style.display="none")},window.AppSMClose=function(){"Main"===Xn.name&&(document.querySelector(".settings-menu").style.animationName="pull-up",document.querySelector(".settings-menu").style.animationDuration="0.45s",document.querySelector(".settings-menu").style.animationFillMode="forwards",document.querySelector("#keys").style.animationName="pull-down",document.querySelector("#keys").style.animationDuration="0.5s",setTimeout((()=>{document.querySelector(".settings-menu").style.display="none",document.querySelector(".settings-menu").style.animationName="pull-down",document.querySelector("#keys").style.display="grid"}),250))},window._OldFetch=window.fetch,window.fetch=async(e,t)=>(e=`${Xn.relay}${e}`,window._OldFetch(e,t));const Xn={compareVersions:(e,t)=>{const n=Cn(e),a=Cn(t),o=n.pop(),s=a.pop(),i=Tn(n,a);return 0!==i?i:o&&s?Tn(o.split("."),s.split(".")):o||s?o?-1:1:0},relay:"",_socket:null,_ca:[],_Uploads_View:0,lastRetry:-1,connected:!1,reconnect:()=>{Xn.connected=!1,Xn.lastRetry=new Date,Xn._socket.connect(),Xn._ca.push(Xn.lastRetry)},wakeLock:{sentinel:null,request:async()=>{if("wakeLock"in navigator)try{Xn.wakeLock.sentinel=await navigator.wakeLock.request("screen"),Xn.CLU("Boot / WakeLock","Wake lock acquired.")}catch(e){console.error(`${e.name}, ${e.message}`),Xn.sendToast("Failed to acquire wake lock.")}}},lclCfg:()=>Xn._information.style||{compact:!1},_information:{},_init:!1,_authStatus:!1,_tyc:new Map,_serverRequiresAuth:!0,page:0,events:{},config:{},_loginAllowed:!1,keys:document.querySelector("#keys")?document.querySelector("#keys"):document.createElement("div"),notibar:document.querySelector("#snackbar")?document.querySelector("#snackbar"):document.createElement("div"),save:(e,t)=>localStorage.setItem(Xn.storage.prefix(e),t),load:e=>{if(localStorage.getItem(btoa(`fd.${e}`))){const t=localStorage.getItem(btoa(`fd.${e}`));localStorage.removeItem(btoa(`fd.${e}`)),Xn.CLU("Storage",`Migrated ${e} to new storage format.`),Xn.save(e,atob(t))}return localStorage.getItem(Xn.storage.prefix(e))||null},remove:e=>localStorage.removeItem(Xn.storage.prefix(e)),exists:e=>null!=localStorage.getItem(Xn.storage.prefix(e)),default:(e,t)=>(Xn.CLU("Default",`Setting ${e} to ${t}`),Xn.exists(e)?Xn.load(e):Xn.save(e,t)),loadObj:(e,t={})=>{try{return JSON.parse(Xn.load(e))||t}catch(n){return console.error("Error while loading object",e,n),t}},saveObj:(e,t)=>Xn.save(e,JSON.stringify(t)),flags:{_cache:{},reload:()=>{Xn.flags._cache=Xn.loadObj("flags")||{}},isEnabled:e=>"true"===Xn.flags._cache[e],set:(e,t)=>{Xn.flags._cache[e]=t,Xn.save("flags",JSON.stringify(Xn.flags._cache))},toggle:e=>{Xn.flags._cache[e]="true"===Xn.flags._cache[e]?"false":"true",Xn.save("flags",JSON.stringify(Xn.flags._cache))}},storage:{prefix:e=>`freedeck:${e}`,keys:()=>{const e=[];for(const t of Object.keys(localStorage))e.push(t);return e},reset:()=>{for(const e of Object.keys(localStorage))localStorage.removeItem(e),location.reload()}},waitForElement:(e,t)=>{const n=document.querySelector(e);if(n)t(n);else{const n=new MutationObserver((a=>{document.querySelector(e)&&(n.disconnect(),t(document.querySelector(e)))}));n.observe(document.body,{childList:!0,subtree:!0})}},showSpinner:(e=document.body)=>{const t=document.createElement("div");t.className="spinner",e.appendChild(t)},updatePlaying:()=>{if(document.querySelector(".now-playing")){const e=[];for(const t of Xn.audioClient._nowPlaying)e.push(t.getAttribute("data-name"));document.querySelector(".now-playing").innerText=e}},embedded_settings:{createSelect:async(e,t,n,a,o,s=()=>{})=>{const i=document.createElement("div");i.className="es-setting";const r=document.createElement("select");r.id=t;const l=document.createElement("label");l.innerText=e,l.htmlFor=t,i.appendChild(l),i.appendChild(r);const d=await n,c=await a;for(const e of d){const t=document.createElement("option");t.value=e,t.innerText=c[d.indexOf(e)],e===o&&(t.selected=!0),r.appendChild(t)}return-1===r.selectedIndex&&(r.selectedIndex=0),r.onchange=e=>{Xn.uiSounds.playSound("step_2"),s(e)},i}},audioClient:Rn,login:e=>{Xn.send(Xn.events.login.login_data,{tlid:Xn._information.tempLoginID}),Xn.send(Xn.events.login.login,{passwd:e})},theming:Jn,themes:[],imported_scripts:[],import:e=>{Xn.imported_scripts.push(e);const t=document.createElement("script");t.src=e,t.id=e.split("/").pop().split(".").shift(),document.body.appendChild(t)},ExportReportData:()=>{const e=Date.now();console.log("<h2>Exporting..</h2>"),console.log("<h3>Decoding Notification Log</h3>");const t=Xn.loadObj("logs/notif");console.log("<p>The notification log can get large, so this may take some time.</p>"),console.log(`<p>Your log is ${t.length} items long.</p>`),console.log("<h3>Decoded Notification Log.</h3>"),console.log("<p>Now, we're putting it all together.</p>");const n={};Object.assign(n,Xn),n._socket=`C=${Xn._socket.connected},U=${Xn._socket.io.uri}`,n.keys="DOM element";const a={erdStart:e,time:Date.now(),page:window.location.pathname,state:n,ls:{keys:Xn.storage.keys(),ls:localStorage},client_nlog:t,client_cfg:Xn.lclCfg(),errLog:Xn.ErrorLog,client_bootlog:Xn.CLUL},o=Date.now();return a.erdEnd=o,a.exportTimeElapsed=o-e,JSON.stringify(a)},CL:!0,CLUL:[["Page loaded",Date.now()]],showBootLog:Nn.UI.showBootLog,CLU:(e,...t)=>{Xn.CL&&console.log(`${e}:`,...t);const n=document.createElement("code");n.innerText=`${e}: ${t}\n`,Xn.CLUL.push([n.innerText,Date.now()]),document.querySelector("#boot-log").appendChild(n)},doInitialize:(e,t,...n)=>{try{Xn.CLU(`Systems/${t.name}`,`Initializing ${t.name}...`),e(...n),Xn.CLU(`Systems/${t.name}`,`Initialized ${t.name}!`)}catch(e){Xn.CLU(`Systems/${t.name}`,`Error while initializing system: ${e}`)}},init:e=>new Promise(((t,n)=>{fetch("/connect/webpack").then((e=>e.json())).then((t=>{1!==t.compiled&&(window.location.href=`/new-connect.html?id=${e}`)})),Nn.UI.makeBootLog(),(0,Kn.lE)(),Xn.CLU("Boot","(PRE LOG CREATION) Init promise created"),Xn.CLU("Boot","Boot log created"),Xn.CLU("Boot","Attempting to run LS migrations");try{Xn.CLU("Boot","Pre-init"),Xn._initFn(e).then((async()=>{Xn.CLU("Boot",`Received full configuration (${Object.keys(Xn.config).length} objects translated from ${Object.keys(Xn._information).length})`),Xn.CLU("Boot","Running post-init tasks"),Xn.doInitialize(Xn.theming.initialize,{name:"Theme Engine"},Xn),Xn.doInitialize(Nn.UI.initialize,{name:"UI"},Xn),Xn.doInitialize(Xn.audioClient.initialize,{name:"Audio Engine"},Xn),Xn.doInitialize(Xn.uiSounds.initialize,{name:"UI Sounds"},Xn),Xn.CLU("Boot","Post-init tasks completed."),Xn.CLU("Boot","Attempting to run localization."),Xn.sendEvent("launch"),Nn.UI.closeBootLog().then((()=>{Xn.CLU("Boot","Boot log closed."),(0,Kn.lE)(),t(!0)}))}))}catch(e){console.error(`${e} | Universal: initialize failed.`),n(e)}})),repositoryManager:In,uiSounds:Yn,_cb:[],keySet:()=>{let e=!1;null!=Xn.lclCfg()&&(e=Xn.lclCfg().center),Xn.keys.innerHTML="";for(let t=0;t<Xn.config.iconCountPerPage;t++){const n=document.createElement("div");n.className=`button k-${t} unset k ${e?"tiles-center":""}`,Xn.keys.appendChild(n)}let t=[{name:"Stop All",onclick:e=>{Xn.send(Xn.events.keypress,{builtIn:!0,data:"stop-all"})}},{name:"Reload",onclick:e=>{window.location.reload()}},{name:"Settings",onclick:e=>{window.AppSM()},handlers:["onmousedown"],onmousedown:Nn.UI.quickActions}];"true"===Xn.load("nopreset")&&(t=[]);for(const n of t){const t=document.createElement("div"),a="button builtin k "+(e?"tiles-center":"");if(t.innerText=n.name,t.onclick=n.onclick,"Settings"===n.name&&(t.innerText="",t.id="fd-settings-button",t.style.backgroundImage="url(/common/icons/fd.png)",t.style.border="none",t.style.backgroundColor="transparent",t.style.boxShadow="none"),n.handlers)for(const e of n.handlers)t[e]=n[e];t.className=a,Xn.keys.appendChild(t)}},connHelpWizard:()=>new Promise(((e,t)=>{Xn.listenFor("finish_conn",e),Xn.vopen("prompts")})),Pages:{},reloadProfile:()=>{Xn.app_sounds=Xn.config.profiles[Xn.config.profile];for(let e=0;e<Xn.app_sounds.length/Xn.config.iconCountPerPage;e++)Xn.Pages[e]=!0},listenFor:(e,t)=>{Xn._cb.push([e,t])},listenForOnce:(e,t)=>{Xn._cb.push([e,(...n)=>{t(...n),Xn._cb=Xn._cb.filter((t=>t[0]!==e))}])},sendEvent:(e,...t)=>{for(const n of Xn._cb)n[0]===e&&n[1](...t)},decompressGzipBlob(e,t){t(null,Sn.inflate(new Uint8Array(e),{to:"string"}))},asyncDecompressGzipBlob:e=>new Promise(((t,n)=>{Xn.decompressGzipBlob(e,((e,a)=>{e?n(e):t(a)}))})),name:"",_initFn:e=>new Promise(((t,n)=>{try{Xn.CLU("InitFN","Starting init function"),window.universal=Xn,Xn.CLU("InitFN","Copied universal to window"),Xn._socket=io(),Xn.CLU("InitFN","Preflight: connection to socket"),Xn._socket.on("connect",(()=>{if(Xn.CLU("InitFN","We're connected to the server!"),Xn.connected=!0,Xn.name=e,-1!==Xn.lastRetry)return Xn.CLU("InitFN","This is a reconnection."),Xn.sendToast("Reconnected to server."),Xn._socket.disconnect(),void window.location.reload();Xn.CLU("InitFN","Starting dataHandler"),function(e,t){return e.CLU("Incoming Data Handler","Taking over for now."),new Promise(((n,a)=>{e.on(1,(n=>{e.CLU("Incoming Data Handler",`Connection failed. Retrying. Reason: ${n}`),e.send(0,t)})),e.CLU("Incoming Data Handler","Created promise, listening for Identify event."),e.ui=Nn.UI,e.on("I",(async a=>{e.CLU("Incoming Data Handler","Caught Identify event."),e.connected=!0,window.universal=e,e.CLU("Incoming Data Handler","Re-copied Universal to window.");const o=await e.asyncDecompressGzipBlob(a);e.CLU("Incoming Data Handler","Decompressed data.");const s=JSON.parse(o);e.CLU("Incoming Data Handler","Parsed data."),e._information=JSON.parse(o),e.CLU("Incoming Data Handler:Setup","Set raw server info"),e.events=s.events,e.CLU("Incoming Data Handler:Setup","Set events"),e.config=s.config,e.CLU("Incoming Data Handler:Setup","Set Config"),console.log(s),e.app_sounds=s.config.profiles[s.config.profile],e.CLU("Incoming Data Handler:Setup","Set Config Sounds"),e.plugins=s.plugins,e.CLU("Incoming Data Handler:Setup","Set plugins"),e._serverRequiresAuth=e.config.useAuthentication,e.CLU("Incoming Data Handler:Setup","Set serverRequiresAuth"),e._init=!0,e.CLU("Incoming Data Handler:Setup","_init: Completed."),e.CLU("Incoming Data Handler","Creating defaults."),e.default("logs/notif",JSON.stringify([])),e.default("playback-mode","play_over"),e.default("vol-0",1),e.default("vol-1",1),e.default("pitch",1),e.default("uiSounds",!0),e.default("flags",JSON.stringify({})),e.default("has_setup","false"),e.default("theme","default"),e.default("profile","Default"),e.default("repos.community",JSON.stringify([])),e.flags.reload(),e.load("welcomed")||(e.sendToast("Welcome to Freedeck."),e.CLU("Incoming Data Handler","Welcomed user."),e.save("welcomed","true")),e.CLU("Incoming Data Handler","Saved TempLoginID."),e.save("tempLoginID",s.tempLoginID),e.keys.id="keys",e.CLU("Incoming Data Handler","Forcefully setting keys ID."),document.querySelector("#keys")||(e.CLU("Incoming Data Handler","Appending/Creating keys to body."),document.body.appendChild(e.keys)),e.notibar.id="snackbar",e.CLU("Incoming Data Handler","Forcefully setting notibar ID."),document.querySelector("#snackbar")||(e.CLU("Incoming Data Handler","Appending/Creating notibar to body."),document.body.appendChild(e.notibar)),e.CLU("Incoming Data Handler","Setting up sidebar."),(0,Pn.default)(),e.send(e.events.information,{apiVersion:"2"}),e.CLU("Incoming Data Handler","Identified ourselves as Companion APIv2."),"Companion"===e.name&&(e.repositoryManager.unofficial=e.loadObj("repos.community",[])||[],e.CLU("Incoming Data Handler","Setup unofficial repositories.")),e.CLU("Incoming Data Handler","Setting up plugins for Tile Editor.");for(const t of Object.keys(e.plugins)){const n=e.plugins[t];for(const t of n.types)e.CLU("Incoming Data Handler",`Type: ${t.name} -> ${n.name} (aka. ${n.id})`),e._tyc.set(t,n)}if("Companion"===t&&(Dn(),Nn.UI.reloadPluginViews(),e.CLU("Incoming Data Handler","Native handler created."),e._information.nbws)){const e=document.createElement("iframe");e.src="/companion/open_native.html",e.style.display="none",document.body.appendChild(e)}zn(),e.CLU("Incoming Data Handler","Generic native handler created. Resolving as we're finished here."),n(!0)})),e.CLU("Incoming Data Handler","Sent Identify packet"),e.send(0,t)}))}(Xn,e).then((()=>{Xn.CLU("InitFN","Starting eventsHandler"),function(e,t){return new Promise(((n,a)=>{e.CLU("Event Handler","Creating event handlers..."),e.on(e.events.login.unauthorized,(()=>e.sendToast("You are not authenticated!"))),e.on(e.events.login.session_validation_failure,(()=>e.sendToast("Login not allowed! Session could not be verified against server."))),e.on(e.events.companion.set_theme,(t=>{e.theming.setTheme(t,!1)})),e.on(e.events.companion.set_profile,(t=>{e.config.profile=t,Nn.UI.reloadProfile(),Nn.UI.reloadSounds(),e.sendEvent("profile",t)})),e.on(e.events.keypress,(n=>{if(!t.includes("Companion"))return;if("fd.stopall"===n.type)return void e.audioClient.stopAll();if(e.sendEvent("button",n),"fd.sound"!==n.type)return;e.reloadProfile();const a=e.app_sounds.filter((e=>e[Object.keys(e)[0]].uuid===n.uuid))[0];e.load("playback-mode")||e.save("playback-mode","play_over"),e.audioClient.play({file:`${n.data.path}/${n.data.file}`,name:Object.keys(a)[0],channel:e.audioClient.channels.cable}),e.audioClient.play({file:`${n.data.path}/${n.data.file}`,name:Object.keys(a)[0],channel:e.audioClient.channels.monitor})})),e.on(e.events.default.recompile,(()=>{window.location.href=`/new-connect.html?id=${t}`})),e.on(e.events.default.log,(e=>{console.log(`${e.sender}: ${e.data}`)})),e.on(e.events.default.notif,(t=>{t.incoming||("handoff-api"!==t.sender?(t.isCon||e.sendToast(`${t.data}`,t.sender),t.isCon&&e.sendEvent("notif",t)):function(t){if("Authorize"===t.data&&t.incoming&&"Companion"===e.name)showPick(`${t.incoming.appInformation.title} wants to connect to your Freedeck!`,[{value:"true",name:"Authorize"},{value:"false",name:"Deny"}],(({value:n})=>{e.send(e.events.rpc.reply,JSON.stringify({id:t.incoming.appInformation.id,nonce:t.incoming.nonce,value:n.value}))}),t.incoming.appInformation.authorizationMessage,!1);else if("handoff-api"===t.sender&&t.data.startsWith("hid.c ")){const t=notification.data.split("hid.c ")[1].split(" |")[0],n=JSON.parse(notification.data.split(`hid.c ${t} |`)[1]);"ui-sound"===t&&e.uiSounds.playSound(n.sound)}}(t))})),e._socket.on("disconnect",(()=>{e.connected=!1,e.sendToast("Disconnected from server.","Server"),e.lastRetry=new Date;const t=setInterval((()=>{e.sendToast("Attempting to reconnect..."),e.reconnect(),setTimeout((()=>{!0===e.connected&&clearInterval(t)}),1500)}),2e3)})),e.on(e.events.login.login_data_ack,(t=>{e._loginAllowed=t})),e.on(e.events.default.reload,(()=>window.location.reload())),e.on(e.events.default.config_changed,(t=>{document.documentElement.style.setProperty("--font-size",`${t["font-size"]}px`),"Companion"!==e.name&&(document.documentElement.style.setProperty("--tile-width",`${t.buttonSize}rem`),document.documentElement.style.setProperty("--tile-height",`${t.buttonSize}rem`));let n="repeat(5, 2fr)";t.tileCols&&(n=n.replace("5",t.tileCols)),e.save("nopreset",t.nopreset),document.documentElement.style.setProperty("--tile-columns",n),e.lclCfg=()=>t,e.lclCfg().iconCountPerPage=Number.parseInt(t.iconCountPerPage),e.sendEvent("local-config",t),Nn.UI.reloadSounds()})),e.on(e.events.default.reload_sounds,(t=>{e.config.profiles[e.config.profile]=t,Nn.UI.reloadSounds()})),e.on(e.events.default.login,(t=>{e.authStatus=t,!1===t&&(e.sendToast("Incorrect password!"),document.querySelector("#login-dialog")&&(document.querySelector("#login-dialog").style.display="flex")),e.sendEvent("auth",t)})),e.sendEvent("init"),e.CLU("Event Handler","Created event handlers, sending init event.");const o="Main"===e.name?"client":"companion";e.CLU("Event Handler","Loading hooks...");let s=0;for(const e of document.querySelectorAll(".fd-hook"))e.remove();for(const t of Object.keys(e.plugins)){const n=e.plugins[t];for(const t of n.hooks.filter((t=>t.type===("Main"===e.name?0:1)))){const n=document.createElement("script");n.classList.add("fd-hook"),n.classList.add(`fd-hook-${o}`),n.src=`/user-data/hooks/${t.name}`,e.CLU("Event Handler",`Loaded ${o} hook: ${t.name}`),s++,document.body.appendChild(n)}}e.CLU("Event Handler",`Loaded ${s} ${o} hooks from ${Object.keys(e.plugins).length} plugins.`),e.sendEvent("loadHooks"),e.CLU("Event Handler","Tell plugins that their hooks are loaded."),n(!0)}))}(Xn,e).then((()=>{t(!0)}))}))})),Xn.CLU("InitFN / WakeLock","Attempting to grab wake lock."),Xn.wakeLock.request(),Xn.CLU("InitFN","Boot completed.")}catch(e){console.error(e),n(e)}})),sendToast:(e,t="")=>{if(HTMLElement.prototype.setHTML||(HTMLElement.prototype.setHTML=function(e){this.innerHTML=Xn.cleanHTML(e)}),!document.querySelector("#snackbar")){const e=document.createElement("div");e.id="snackbar",document.body.appendChild(e)}const n=document.createElement("div");n.setHTML(`<h3>${t}</h3>${e}`),n.classList.add("toast"),n.classList.add("show"),n.onclick=()=>{n.className=n.className.replace("show",""),n.remove()},Xn.uiSounds.playSound("notification"),document.querySelector("#snackbar").appendChild(n),setTimeout((()=>{n.className=n.className.replace("show","hide"),setTimeout((()=>{n.remove()}),500)}),3e3);const a={timestamp:new Date,page:window.location.pathname,message:e};if(Xn.loadObj("logs/notif").length>0&&!Xn.flags.isEnabled("notification-log"))Xn.saveObj("logs/notif",[]);else if(Xn.loadObj("logs/notif").length>128&&Xn.saveObj("logs/notif",[]),Xn.flags.isEnabled("notification-log")){const e=Xn.loadObj("logs/notif");e.push(a),Xn.saveObj("logs/notif",e)}},send:(e,t)=>{Xn._socket.emit(e,t)},on:(e,t)=>{Xn._socket.on(e,t)},once:(e,t)=>{Xn._socket.once(e,t)},log:(e,t="Universal")=>{Xn.send(Xn.events.default.log,{sender:t,data:e}),console.log(`[${t}] ${e}`)},ErrorLog:[],createTooltipFor:(e,t)=>{const n=document.createElement("div");return n.className="tooltip",n.innerHTML=t,document.body.appendChild(n),e.onmouseleave=()=>{n.classList.remove("show")},e.onmouseenter=()=>{n.classList.add("show")},e.onmousemove=e=>{n.style.top=`${e.clientY}px`,n.style.left=`${e.clientX}px`},n},cleanHTML(e,t){function n(e,t){const n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:"))||!!e.startsWith("on")||void 0}function a(e){const t=e.attributes;for(const{name:a,value:o}of t)n(a,o)&&e.removeAttribute(a)}const o=(new DOMParser).parseFromString(e,"text/html").body||document.createElement("body");return function(e){const t=e.querySelectorAll("script");for(const e of t)e.remove()}(o),function e(t){const n=t.children;for(const t of n)a(t),e(t)}(o),t?o.childNodes:o.innerHTML}};window.universal=Xn,window.onerror=(e,t,n,a,o)=>{document.querySelector("#keys").style.display="none";let s=document.createElement("dialog");if(document.querySelector("#error-dialog"))s=document.querySelector("#error-dialog");else{s.id="error-dialog",s.classList.add("modal");const o=document.createElement("div");o.innerHTML=`\n    <h1>Freedeck</h1>\n    <p>\n      Freedeck has encountered an error. This does not crash the app, but may cause unexpected behavior.\n    </p>\n\t\t<small>Handler: universal</small>\n    <details open>\n      <summary>Error Details</summary>\n      <small>\n        ${e} in ${t} at line ${n}:${a}\n      </small>\n    </details>\n    <br>\n    <div class='flex-wrap-r'>\n    <a style='display:block;width:100%;font-size:1.5em;text-align:center;' href='javascript:window.ErrorIgnore();'>Ignore</a>\n    <a style='display:block;width:100%;font-size:1.5em;text-align:center;' href='javascript:window.location.reload();'>Reload</a>\n    </div>\n    <small>Ignoring the error may cause Freedeck to be unusable.</small>\n    `,s.appendChild(o),document.body.appendChild(s),s.showModal()}console.log(e,t,n,a,o)},window.ErrorIgnore=()=>{document.querySelector("#error-dialog").remove(),document.querySelector("#keys").style.display="grid",window.location.href.includes("companion")&&(document.querySelector(".sidebar").style.display="flex")},Xn.UI||(Xn.UI=Nn.UI),Xn.listenFor("animate_page",((e="automated",t="left")=>{if(!0!==Xn.lclCfg().animation)return;const n=document.getElementById("keys");"automated"===e&&(n.style.animation=`pull-${t} 0.5s`)}))},806:()=>{const e=window.universal;HTMLElement.prototype.setHTML||(HTMLElement.prototype.setHTML=function(e){this.innerHTML=e}),e.listenFor("init",(()=>{if(!1!==e._information.config.useAuthentication){if(!e._authStatus){const e=document.createElement("li");e.style.display="none",e.id="login",e.setHTML('<a href="#">Login</a>'),e.onclick=()=>{document.querySelector("#login-msg")&&document.querySelector("#login-msg").setHTML("Login to Freedeck")},e.click(),document.querySelector("#sidebar > ul").appendChild(e)}e.load("password")?(e.login(e.load("password")),document.querySelector("#login-dialog").style.display="none"):(document.querySelector("#login-dialog").style.display="flex",document.querySelector("#login-div").style.opacity="1"),e.on(e.events.login.login,(t=>{!0===t?(e.load("logintime")>Date.now()&&e.sendToast("Logged in!"),document.querySelector("#password")&&""!==document.querySelector("#password").value&&e.save("password",document.querySelector("#password").value),e.save("logintime",Date.now()),document.querySelector("#login-div").style.opacity="0",document.querySelector("#login-dialog").style.opacity="0",setTimeout((()=>{document.querySelector("#login-dialog").remove()}),250)):document.querySelector("#login-msg").setHTML("Login failed.")}))}else e._authStatus=!0}))},850:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(363);const o=document.querySelector("#audio-file"),s=document.querySelector("#type"),i=document.querySelector("#editor-btn");document.querySelector(".view_nested_playback");class r extends a.A{constructor(){super("audio","fd.sound"),this.setOnRun((({interactionData:e})=>{o.innerText=e.data.file})),this.setOnFirstSetup((({interactionData:e})=>{e.type="fd.sound",e.data.file="Unset.mp3",e.data.path="/sounds/",i.setAttribute("data-interaction",JSON.stringify(e)),o.innerText="Unset.mp3",s.value="fd.sound"}))}}const l=r},863:(e,t,n)=>{"use strict";var a=n(656);const o={view_container:"#ctxl-view-cont",as:"html",version:"1.0.0",views:[],addView:e=>{o.views.includes(e)||o.views.push(e)},generateView:e=>{if(!o.views.includes(e))return console.log(`View ${e} not found.`),`<p>View ${e} not found.</p>`;if(document.querySelectorAll(`.ctxv-${e}`).length>0)for(const t of document.querySelectorAll(`.ctxv-${e}`))t.remove();const t=document.createElement(o.as);return t.id=e,t.innerHTML="<p>Loading...</p>",fetch(`./views/${e}.${o.as}`).then((e=>e.text())).then((e=>{t.innerHTML=e})).then((()=>{const n=t.getElementsByTagName("script");for(let t=0;t<n.length;t++){const a=document.createElement("script");a.type="module",a.id=`${e}-script-${t}`,a.classList.add("ctxv_script"),a.classList.add(`ctxv-${e}`),a.text=n[t].text,document.body.appendChild(a)}})),t},opened:[],createViewContainer:()=>{const e=document.createElement("div");return e.id=o.view_container.split("#")[1],e},nonDestructiveView:e=>{document.querySelector(o.view_container)||document.body.appendChild(o.createViewContainer()),document.querySelector(`#${e}`)?document.querySelector(o.view_container).replaceChild(document.querySelector(`#${e}`),o.generateView(e)):document.querySelector(o.view_container).appendChild(o.generateView(e)),o.opened.push(e)},reloadView:e=>{document.querySelector(o.view_container)||document.body.appendChild(o.createViewContainer()),o.onclose[e]&&o.onclose[e](),o.onclose[e]&&delete o.onclose[e];const t=document.querySelectorAll(`.ctxv${e}`);for(let e=0;e<t.length;e++)t[e].remove();document.querySelector(o.view_container).replaceChild(o.generateView(e),document.querySelector(`#${e}`))},destructiveView:e=>{document.querySelector(o.view_container)||document.body.appendChild(o.createViewContainer()),document.querySelector(o.view_container).innerHTML="",document.querySelector(o.view_container).appendChild(o.generateView(e)),o.opened=[e]},waitForClose:async e=>new Promise(((t,n)=>{const a=setInterval((()=>{document.querySelector(`#${e}`)||o.opened.includes(e)||(clearInterval(a),t())}),100)})),onclose:{},closeView:e=>{o.onclose[e]&&o.onclose[e](),document.querySelector(`#${e}`).remove(),o.opened=o.opened.filter((t=>t!==e))}},s=o;universal.ctx=s,document.body.appendChild(s.createViewContainer()),document.body.querySelector(s.view_container).style.display="none",HTMLElement.prototype.setHTML=function(e){this.innerHTML=e},universal.listenFor("init",(()=>{const e=document.createElement("li");e.id="constat",document.querySelector("#sidebar > ul").appendChild(e)})),document.onkeydown=e=>universal.uiSounds.playSound("int_type");const i=["library","plugins","marketplace","settings","prompts","setup","customtheme"];for(const e of i)s.addView(e);const r=document.createElement("div");r.id="sidebar";const l=document.createElement("ul");r.appendChild(l);let d=[];function c(e,t){e&&(e.style.display=t)}function u(e,t){e&&(e.style.animation=t)}universal.reloadRight=()=>{universal.flags.reload(),d=[{Tiles:"index.html"},{Library:"library.html"},{Marketplace:"marketplace.html"},{Settings:"settings.html"}],universal.flags.isEnabled("connect-tab")&&d.push({Connect:"/new-connect.html?id=Companion&new_ip=true"}),"false"===universal.load("has_setup")&&(d=[{Setup:"setup.html"},{"Pair Device":"prompts.html"}]),"true"===universal.load("cte")&&d.push({Themer:"customtheme.html"}),universal.flags.isEnabled("recompile-tab")&&d.push({Recompile:"+universal.send(universal.events.default.recompile)"}),l.setHTML('<li style="font-size: .6em; background: none; margin: 0 auto;">\n\t\t<span style="display:flex;align-items:center;">\n\t\t<img src="/common/icons/fd.png" width="75" height="75" alt="Freedeck" />\n\n\t\t</span>\n\t\t</li>');for(const e of d){const t=Object.keys(e)[0],n=e[t],a=i.find((e=>n.includes(e)))||n;if(n.startsWith("+")){const e=document.createElement("li");e.setHTML(`<a data-i18n-key="sidebar.${t}" onclick="${n.substring(1)}">${t}</a>`),l.appendChild(e);break}const o=document.createElement("li");o.setAttribute("hovereffect","yes"),o.setHTML(`<a data-i18n-key="sidebar.${t}" onclick="universal.vopen('${a}')">${t}</a>`),l.appendChild(o)}(0,a.ih)(l)},universal.reloadRight(),universal.vclose=()=>{const e=document.querySelector(universal.ctx.view_container);u(e,"view-out 0.5s"),setTimeout((()=>{c(e,"none")}),500)},universal.vopen=e=>{if("false"===universal.load("has_setup"))return;universal.uiSounds.playSound("sidebar");const t=document.querySelector(universal.ctx.view_container),n=document.querySelector(".sidebar");if(null!=t){if(!i.includes(e))return"none"===n.style.display&&document.querySelector(".toggle-sidebar button").click(),u(t,"view-out 0.5s"),setTimeout((()=>{c(t,"none")}),500),void(e.startsWith("/")&&(window.location.href=e));c(t,"block"),"flex"===n.style.display&&document.querySelector(".toggle-sidebar button").click(),universal.ctx.destructiveView(e),u(t,"view-in 0.5s"),setTimeout((()=>{(0,a.ih)(t)}),250)}},document.body.appendChild(r)},951:()=>{"use strict";const e={_filter:null,_ctx:null,dragging:!1,_draggedItem:null,_originalIndex:null,_targetIndex:null,no:".builtin",unmovableClass:"unmovable",selectedGlowClass:"glow-tile",movingElementClass:"moving",secondaryAllow:".sal",setFilter:t=>{e._filter=t},setContext:t=>{e._ctx=t,e.load();for(const t of document.querySelectorAll(e._filter))t.setAttribute("draggable","true");for(const t of document.querySelectorAll(`${e.unmovableClass}`))t.setAttribute("draggable","false")},_onDragStart:t=>{if(t.target.matches(e._filter)){e.dragging=!0,e._draggedItem=t.target,e._originalIndex=Array.from(e._ctx.children).indexOf(e._draggedItem),e._draggedItem.classList.add(e.movingElementClass);for(const n of e._eventListeners)"dragging"===n.event&&n.callback(t)}},_onDragEnd:t=>{e.dragging=!1,e._draggedItem=null,e._originalIndex=null,e._targetIndex=null},_onDragOver:e=>{e.preventDefault()},_onDragEnter:t=>{if(e.dragging&&(t.target.matches(e._filter)&&!t.target.matches(e.no)||t.target.matches(e.secondaryAllow))){const n=t.target,a=Array.from(e._ctx.children).indexOf(n);n!==e._draggedItem&&!1===n.classList.contains(e.unmovableClass)?(e._targetIndex=a,n.classList.add(e.selectedGlowClass),n.ondragleave=()=>{n.classList.remove(e.selectedGlowClass)},n.ondragend=()=>{n.classList.remove(e.selectedGlowClass)}):e._targetIndex=null}},_onDrop:t=>{if(t.preventDefault(),t.target===e._ctx)return;if(t.target.matches(e.no))return;const n=e._draggedItem;if(null!==e._targetIndex&&e._targetIndex!==e._originalIndex){const t=e._ctx.children[e._targetIndex],a=n.nextElementSibling===t?n:n.nextElementSibling;t.classList.remove(e.selectedGlowClass),e._ctx.insertBefore(n,t),e._ctx.insertBefore(t,a)}n.classList.remove(e.movingElementClass),null==e._targetIndex&&(e._targetIndex=e._originalIndex);for(const n of e._eventListeners)"drop"===n.event&&n.callback(t,e._originalIndex,e._targetIndex);e._dragging=!1,e._draggedItem=null,e._targetIndex=null},load:()=>{e._ctx.addEventListener("dragstart",e._onDragStart),e._ctx.addEventListener("dragend",e._onDragEnd),e._ctx.addEventListener("dragover",e._onDragOver),e._ctx.addEventListener("dragenter",e._onDragEnter),e._ctx.addEventListener("drop",e._onDrop)},_eventListeners:[],on:(t,n)=>{e._eventListeners.push({event:t,callback:n})}},t=e;t.setFilter("#keys .button"),t.unmovableClass=".builtin, .unset",t.setContext(universal.keys),universal.listenFor("page_change",(()=>{t.setContext(universal.keys)}));const n=document.querySelector(".mt-next-page"),a=document.querySelector(".mt-prev-page");t.on("drop",((e,t,o)=>{if(n.style.display="none",a.style.display="none",e.target.classList.contains("mt-next-page")||e.target.classList.contains("mt-prev-page")){const n=e.target.classList.contains("mt-next-page");universal.page+=n?1:-1,universal.save("page",universal.page),universal.sendEvent("page_change");const a=Number.parseInt(t)+(universal.page<0?1:0)+(universal.page>0?universal.config.iconCountPerPage*universal.page:0);let o=0;if(n)for(const e of universal.config.profiles[universal.config.profile]){if(e.pos!==o)break;o++}const s=document.querySelector(`#keys .button.k-${t}`);return void universal.send(universal.events.companion.move_tile,{name:s.getAttribute("data-name"),item:s.getAttribute("data-interaction"),newIndex:o,oldIndex:a})}const s=Number.parseInt(t)+universal.page*Number.parseInt(universal.config.iconCountPerPage),i=Number.parseInt(o)+universal.page*Number.parseInt(universal.config.iconCountPerPage),r=universal.page<0?1:0,l=document.querySelector(`#keys .button.k-${t}`);l.classList.remove(`k-${t}`),l.classList.add(`k-${o}`),e.target.classList.remove(`k-${o}`),e.target.classList.add(`k-${t}`);const d=JSON.parse(l.getAttribute("data-interaction"));universal.send(universal.events.companion.move_tile,{name:l.getAttribute("data-name"),item:l.getAttribute("data-interaction"),newIndex:i+r,oldIndex:s+r}),l.pos=i,l.setAttribute("data-interaction",JSON.stringify(d))})),t.on("dragging",(e=>{document.querySelector("#keys").appendChild(n.cloneNode(!0)),document.querySelector("#keys").appendChild(a.cloneNode(!0)),n.style.display="flex",a.style.display="flex"}))}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,l),n.exports}l.m=i,e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},l.a=(o,s,i)=>{var r;i&&((r=[]).d=-1);var l,d,c,u=new Set,m=o.exports,p=new Promise(((e,t)=>{c=t,d=e}));p[t]=m,p[e]=e=>(r&&e(r),u.forEach(e),p.catch((e=>{}))),o.exports=p,s((o=>{var s;l=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var s=[];s.d=0,o.then((e=>{i[t]=e,a(s)}),(e=>{i[n]=e,a(s)}));var i={};return i[e]=e=>e(s),i}}var r={};return r[e]=e=>{},r[t]=o,r})))(o);var i=()=>l.map((e=>{if(e[n])throw e[n];return e[t]})),d=new Promise((t=>{(s=()=>t(i)).r=0;var n=e=>e!==r&&!u.has(e)&&(u.add(e),e&&!e.d&&(s.r++,e.push(s)));l.map((t=>t[e](n)))}));return s.r?d:i()}),(e=>(e?c(p[n]=e):d(m),a(r)))),r&&r.d<0&&(r.d=0)},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,n)=>(l.f[n](e,t),t)),[])),l.u=e=>e+".js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},s="freedeck:",l.l=(e,t,n,a)=>{if(o[e])o[e].push(t);else{var i,r;if(void 0!==n)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==s+n){i=u;break}}i||(r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",s+n),i.src=e),o[e]=[t];var m=(t,n)=>{i.onerror=i.onload=null,clearTimeout(p);var a=o[e];if(delete o[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(n))),t)return t(n)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),r&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})(),(()=>{var e={792:0};l.f.j=(t,n)=>{var a=l.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var o=new Promise(((n,o)=>a=e[t]=[n,o]));n.push(a[2]=o);var s=l.p+l.u(t),i=new Error;l.l(s,(n=>{if(l.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,a[1](i)}}),"chunk-"+t,t)}};var t=(t,n)=>{var a,o,[s,i,r]=n,d=0;if(s.some((t=>0!==e[t]))){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);r&&r(l)}for(t&&t(n);d<s.length;d++)o=s[d],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkfreedeck=self.webpackChunkfreedeck||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),l(416)})();